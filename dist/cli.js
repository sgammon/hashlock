"use strict";var Ei=Object.create;var ze=Object.defineProperty;var Ai=Object.getOwnPropertyDescriptor;var Ci=Object.getOwnPropertyNames;var xi=Object.getPrototypeOf,vi=Object.prototype.hasOwnProperty;var Y=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var Oi=(r,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Ci(t))!vi.call(r,i)&&i!==e&&ze(r,i,{get:()=>t[i],enumerable:!(s=Ai(t,i))||s.enumerable});return r};var bt=(r,t,e)=>(e=r!=null?Ei(xi(r)):{},Oi(t||!r||!r.__esModule?ze(e,"default",{value:r,enumerable:!0}):e,r));var yt=Y(le=>{var Pt=class extends Error{constructor(t,e,s){super(s),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=e,this.exitCode=t,this.nestedError=void 0}},he=class extends Pt{constructor(t){super(1,"commander.invalidArgument",t),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}};le.CommanderError=Pt;le.InvalidArgumentError=he});var Vt=Y(ue=>{var{InvalidArgumentError:Hi}=yt(),ce=class{constructor(t,e){switch(this.description=e||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,t[0]){case"<":this.required=!0,this._name=t.slice(1,-1);break;case"[":this.required=!1,this._name=t.slice(1,-1);break;default:this.required=!0,this._name=t;break}this._name.length>3&&this._name.slice(-3)==="..."&&(this.variadic=!0,this._name=this._name.slice(0,-3))}name(){return this._name}_concatValue(t,e){return e===this.defaultValue||!Array.isArray(e)?[t]:e.concat(t)}default(t,e){return this.defaultValue=t,this.defaultValueDescription=e,this}argParser(t){return this.parseArg=t,this}choices(t){return this.argChoices=t.slice(),this.parseArg=(e,s)=>{if(!this.argChoices.includes(e))throw new Hi(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._concatValue(e,s):e},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}};function Fi(r){let t=r.name()+(r.variadic===!0?"...":"");return r.required?"<"+t+">":"["+t+"]"}ue.Argument=ce;ue.humanReadableArgName=Fi});var de=Y(Ue=>{var{humanReadableArgName:ki}=Vt(),fe=class{constructor(){this.helpWidth=void 0,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}visibleCommands(t){let e=t.commands.filter(i=>!i._hidden),s=t._getHelpCommand();return s&&!s._hidden&&e.push(s),this.sortSubcommands&&e.sort((i,n)=>i.name().localeCompare(n.name())),e}compareOptions(t,e){let s=i=>i.short?i.short.replace(/^-/,""):i.long.replace(/^--/,"");return s(t).localeCompare(s(e))}visibleOptions(t){let e=t.options.filter(i=>!i.hidden),s=t._getHelpOption();if(s&&!s.hidden){let i=s.short&&t._findOption(s.short),n=s.long&&t._findOption(s.long);!i&&!n?e.push(s):s.long&&!n?e.push(t.createOption(s.long,s.description)):s.short&&!i&&e.push(t.createOption(s.short,s.description))}return this.sortOptions&&e.sort(this.compareOptions),e}visibleGlobalOptions(t){if(!this.showGlobalOptions)return[];let e=[];for(let s=t.parent;s;s=s.parent){let i=s.options.filter(n=>!n.hidden);e.push(...i)}return this.sortOptions&&e.sort(this.compareOptions),e}visibleArguments(t){return t._argsDescription&&t.registeredArguments.forEach(e=>{e.description=e.description||t._argsDescription[e.name()]||""}),t.registeredArguments.find(e=>e.description)?t.registeredArguments:[]}subcommandTerm(t){let e=t.registeredArguments.map(s=>ki(s)).join(" ");return t._name+(t._aliases[0]?"|"+t._aliases[0]:"")+(t.options.length?" [options]":"")+(e?" "+e:"")}optionTerm(t){return t.flags}argumentTerm(t){return t.name()}longestSubcommandTermLength(t,e){return e.visibleCommands(t).reduce((s,i)=>Math.max(s,e.subcommandTerm(i).length),0)}longestOptionTermLength(t,e){return e.visibleOptions(t).reduce((s,i)=>Math.max(s,e.optionTerm(i).length),0)}longestGlobalOptionTermLength(t,e){return e.visibleGlobalOptions(t).reduce((s,i)=>Math.max(s,e.optionTerm(i).length),0)}longestArgumentTermLength(t,e){return e.visibleArguments(t).reduce((s,i)=>Math.max(s,e.argumentTerm(i).length),0)}commandUsage(t){let e=t._name;t._aliases[0]&&(e=e+"|"+t._aliases[0]);let s="";for(let i=t.parent;i;i=i.parent)s=i.name()+" "+s;return s+e+" "+t.usage()}commandDescription(t){return t.description()}subcommandDescription(t){return t.summary()||t.description()}optionDescription(t){let e=[];return t.argChoices&&e.push(`choices: ${t.argChoices.map(s=>JSON.stringify(s)).join(", ")}`),t.defaultValue!==void 0&&(t.required||t.optional||t.isBoolean()&&typeof t.defaultValue=="boolean")&&e.push(`default: ${t.defaultValueDescription||JSON.stringify(t.defaultValue)}`),t.presetArg!==void 0&&t.optional&&e.push(`preset: ${JSON.stringify(t.presetArg)}`),t.envVar!==void 0&&e.push(`env: ${t.envVar}`),e.length>0?`${t.description} (${e.join(", ")})`:t.description}argumentDescription(t){let e=[];if(t.argChoices&&e.push(`choices: ${t.argChoices.map(s=>JSON.stringify(s)).join(", ")}`),t.defaultValue!==void 0&&e.push(`default: ${t.defaultValueDescription||JSON.stringify(t.defaultValue)}`),e.length>0){let s=`(${e.join(", ")})`;return t.description?`${t.description} ${s}`:s}return t.description}formatHelp(t,e){let s=e.padWidth(t,e),i=e.helpWidth||80,n=2,o=2;function h(m,p){if(p){let w=`${m.padEnd(s+o)}${p}`;return e.wrap(w,i-n,s+o)}return m}function a(m){return m.join(`
`).replace(/^/gm," ".repeat(n))}let l=[`Usage: ${e.commandUsage(t)}`,""],c=e.commandDescription(t);c.length>0&&(l=l.concat([e.wrap(c,i,0),""]));let u=e.visibleArguments(t).map(m=>h(e.argumentTerm(m),e.argumentDescription(m)));u.length>0&&(l=l.concat(["Arguments:",a(u),""]));let f=e.visibleOptions(t).map(m=>h(e.optionTerm(m),e.optionDescription(m)));if(f.length>0&&(l=l.concat(["Options:",a(f),""])),this.showGlobalOptions){let m=e.visibleGlobalOptions(t).map(p=>h(e.optionTerm(p),e.optionDescription(p)));m.length>0&&(l=l.concat(["Global Options:",a(m),""]))}let d=e.visibleCommands(t).map(m=>h(e.subcommandTerm(m),e.subcommandDescription(m)));return d.length>0&&(l=l.concat(["Commands:",a(d),""])),l.join(`
`)}padWidth(t,e){return Math.max(e.longestOptionTermLength(t,e),e.longestGlobalOptionTermLength(t,e),e.longestSubcommandTermLength(t,e),e.longestArgumentTermLength(t,e))}wrap(t,e,s,i=40){let n=" \\f\\t\\v\xA0\u1680\u2000-\u200A\u202F\u205F\u3000\uFEFF",o=new RegExp(`[\\n][${n}]+`);if(t.match(o))return t;let h=e-s;if(h<i)return t;let a=t.slice(0,s),l=t.slice(s).replace(`\r
`,`
`),c=" ".repeat(s),f="\\s\u200B",d=new RegExp(`
|.{1,${h-1}}([${f}]|$)|[^${f}]+?([${f}]|$)`,"g"),m=l.match(d)||[];return a+m.map((p,w)=>p===`
`?"":(w>0?c:"")+p.trimEnd()).join(`
`)}};Ue.Help=fe});var we=Y(ge=>{var{InvalidArgumentError:Ti}=yt(),pe=class{constructor(t,e){this.flags=t,this.description=e||"",this.required=t.includes("<"),this.optional=t.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(t),this.mandatory=!1;let s=Ri(t);this.short=s.shortFlag,this.long=s.longFlag,this.negate=!1,this.long&&(this.negate=this.long.startsWith("--no-")),this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0}default(t,e){return this.defaultValue=t,this.defaultValueDescription=e,this}preset(t){return this.presetArg=t,this}conflicts(t){return this.conflictsWith=this.conflictsWith.concat(t),this}implies(t){let e=t;return typeof t=="string"&&(e={[t]:!0}),this.implied=Object.assign(this.implied||{},e),this}env(t){return this.envVar=t,this}argParser(t){return this.parseArg=t,this}makeOptionMandatory(t=!0){return this.mandatory=!!t,this}hideHelp(t=!0){return this.hidden=!!t,this}_concatValue(t,e){return e===this.defaultValue||!Array.isArray(e)?[t]:e.concat(t)}choices(t){return this.argChoices=t.slice(),this.parseArg=(e,s)=>{if(!this.argChoices.includes(e))throw new Ti(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._concatValue(e,s):e},this}name(){return this.long?this.long.replace(/^--/,""):this.short.replace(/^-/,"")}attributeName(){return $i(this.name().replace(/^no-/,""))}is(t){return this.short===t||this.long===t}isBoolean(){return!this.required&&!this.optional&&!this.negate}},me=class{constructor(t){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,t.forEach(e=>{e.negate?this.negativeOptions.set(e.attributeName(),e):this.positiveOptions.set(e.attributeName(),e)}),this.negativeOptions.forEach((e,s)=>{this.positiveOptions.has(s)&&this.dualOptions.add(s)})}valueFromOption(t,e){let s=e.attributeName();if(!this.dualOptions.has(s))return!0;let i=this.negativeOptions.get(s).presetArg,n=i!==void 0?i:!1;return e.negate===(n===t)}};function $i(r){return r.split("-").reduce((t,e)=>t+e[0].toUpperCase()+e.slice(1))}function Ri(r){let t,e,s=r.split(/[ |,]+/);return s.length>1&&!/^[[<]/.test(s[1])&&(t=s.shift()),e=s.shift(),!t&&/^-[^-]$/.test(e)&&(t=e,e=void 0),{shortFlag:t,longFlag:e}}ge.Option=pe;ge.DualOptions=me});var qe=Y(Ge=>{function Di(r,t){if(Math.abs(r.length-t.length)>3)return Math.max(r.length,t.length);let e=[];for(let s=0;s<=r.length;s++)e[s]=[s];for(let s=0;s<=t.length;s++)e[0][s]=s;for(let s=1;s<=t.length;s++)for(let i=1;i<=r.length;i++){let n=1;r[i-1]===t[s-1]?n=0:n=1,e[i][s]=Math.min(e[i-1][s]+1,e[i][s-1]+1,e[i-1][s-1]+n),i>1&&s>1&&r[i-1]===t[s-2]&&r[i-2]===t[s-1]&&(e[i][s]=Math.min(e[i][s],e[i-2][s-2]+1))}return e[r.length][t.length]}function Ni(r,t){if(!t||t.length===0)return"";t=Array.from(new Set(t));let e=r.startsWith("--");e&&(r=r.slice(2),t=t.map(o=>o.slice(2)));let s=[],i=3,n=.4;return t.forEach(o=>{if(o.length<=1)return;let h=Di(r,o),a=Math.max(r.length,o.length);(a-h)/a>n&&(h<i?(i=h,s=[o]):h===i&&s.push(o))}),s.sort((o,h)=>o.localeCompare(h)),e&&(s=s.map(o=>`--${o}`)),s.length>1?`
(Did you mean one of ${s.join(", ")}?)`:s.length===1?`
(Did you mean ${s[0]}?)`:""}Ge.suggestSimilar=Ni});var Ze=Y(Xe=>{var Ii=require("events").EventEmitter,be=require("child_process"),X=require("path"),ye=require("fs"),E=require("process"),{Argument:Mi,humanReadableArgName:Li}=Vt(),{CommanderError:Se}=yt(),{Help:ji}=de(),{Option:Ke,DualOptions:Pi}=we(),{suggestSimilar:Je}=qe(),_e=class r extends Ii{constructor(t){super(),this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!0,this.registeredArguments=[],this._args=this.registeredArguments,this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=t||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._outputConfiguration={writeOut:e=>E.stdout.write(e),writeErr:e=>E.stderr.write(e),getOutHelpWidth:()=>E.stdout.isTTY?E.stdout.columns:void 0,getErrHelpWidth:()=>E.stderr.isTTY?E.stderr.columns:void 0,outputError:(e,s)=>s(e)},this._hidden=!1,this._helpOption=void 0,this._addImplicitHelpCommand=void 0,this._helpCommand=void 0,this._helpConfiguration={}}copyInheritedSettings(t){return this._outputConfiguration=t._outputConfiguration,this._helpOption=t._helpOption,this._helpCommand=t._helpCommand,this._helpConfiguration=t._helpConfiguration,this._exitCallback=t._exitCallback,this._storeOptionsAsProperties=t._storeOptionsAsProperties,this._combineFlagAndOptionalValue=t._combineFlagAndOptionalValue,this._allowExcessArguments=t._allowExcessArguments,this._enablePositionalOptions=t._enablePositionalOptions,this._showHelpAfterError=t._showHelpAfterError,this._showSuggestionAfterError=t._showSuggestionAfterError,this}_getCommandAndAncestors(){let t=[];for(let e=this;e;e=e.parent)t.push(e);return t}command(t,e,s){let i=e,n=s;typeof i=="object"&&i!==null&&(n=i,i=null),n=n||{};let[,o,h]=t.match(/([^ ]+) *(.*)/),a=this.createCommand(o);return i&&(a.description(i),a._executableHandler=!0),n.isDefault&&(this._defaultCommandName=a._name),a._hidden=!!(n.noHelp||n.hidden),a._executableFile=n.executableFile||null,h&&a.arguments(h),this._registerCommand(a),a.parent=this,a.copyInheritedSettings(this),i?this:a}createCommand(t){return new r(t)}createHelp(){return Object.assign(new ji,this.configureHelp())}configureHelp(t){return t===void 0?this._helpConfiguration:(this._helpConfiguration=t,this)}configureOutput(t){return t===void 0?this._outputConfiguration:(Object.assign(this._outputConfiguration,t),this)}showHelpAfterError(t=!0){return typeof t!="string"&&(t=!!t),this._showHelpAfterError=t,this}showSuggestionAfterError(t=!0){return this._showSuggestionAfterError=!!t,this}addCommand(t,e){if(!t._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);return e=e||{},e.isDefault&&(this._defaultCommandName=t._name),(e.noHelp||e.hidden)&&(t._hidden=!0),this._registerCommand(t),t.parent=this,t._checkForBrokenPassThrough(),this}createArgument(t,e){return new Mi(t,e)}argument(t,e,s,i){let n=this.createArgument(t,e);return typeof s=="function"?n.default(i).argParser(s):n.default(s),this.addArgument(n),this}arguments(t){return t.trim().split(/ +/).forEach(e=>{this.argument(e)}),this}addArgument(t){let e=this.registeredArguments.slice(-1)[0];if(e&&e.variadic)throw new Error(`only the last argument can be variadic '${e.name()}'`);if(t.required&&t.defaultValue!==void 0&&t.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${t.name()}'`);return this.registeredArguments.push(t),this}helpCommand(t,e){if(typeof t=="boolean")return this._addImplicitHelpCommand=t,this;t=t??"help [command]";let[,s,i]=t.match(/([^ ]+) *(.*)/),n=e??"display help for command",o=this.createCommand(s);return o.helpOption(!1),i&&o.arguments(i),n&&o.description(n),this._addImplicitHelpCommand=!0,this._helpCommand=o,this}addHelpCommand(t,e){return typeof t!="object"?(this.helpCommand(t,e),this):(this._addImplicitHelpCommand=!0,this._helpCommand=t,this)}_getHelpCommand(){return this._addImplicitHelpCommand??(this.commands.length&&!this._actionHandler&&!this._findCommand("help"))?(this._helpCommand===void 0&&this.helpCommand(void 0,void 0),this._helpCommand):null}hook(t,e){let s=["preSubcommand","preAction","postAction"];if(!s.includes(t))throw new Error(`Unexpected value for event passed to hook : '${t}'.
Expecting one of '${s.join("', '")}'`);return this._lifeCycleHooks[t]?this._lifeCycleHooks[t].push(e):this._lifeCycleHooks[t]=[e],this}exitOverride(t){return t?this._exitCallback=t:this._exitCallback=e=>{if(e.code!=="commander.executeSubCommandAsync")throw e},this}_exit(t,e,s){this._exitCallback&&this._exitCallback(new Se(t,e,s)),E.exit(t)}action(t){let e=s=>{let i=this.registeredArguments.length,n=s.slice(0,i);return this._storeOptionsAsProperties?n[i]=this:n[i]=this.opts(),n.push(this),t.apply(this,n)};return this._actionHandler=e,this}createOption(t,e){return new Ke(t,e)}_callParseArg(t,e,s,i){try{return t.parseArg(e,s)}catch(n){if(n.code==="commander.invalidArgument"){let o=`${i} ${n.message}`;this.error(o,{exitCode:n.exitCode,code:n.code})}throw n}}_registerOption(t){let e=t.short&&this._findOption(t.short)||t.long&&this._findOption(t.long);if(e){let s=t.long&&this._findOption(t.long)?t.long:t.short;throw new Error(`Cannot add option '${t.flags}'${this._name&&` to command '${this._name}'`} due to conflicting flag '${s}'
-  already used by option '${e.flags}'`)}this.options.push(t)}_registerCommand(t){let e=i=>[i.name()].concat(i.aliases()),s=e(t).find(i=>this._findCommand(i));if(s){let i=e(this._findCommand(s)).join("|"),n=e(t).join("|");throw new Error(`cannot add command '${n}' as already have command '${i}'`)}this.commands.push(t)}addOption(t){this._registerOption(t);let e=t.name(),s=t.attributeName();if(t.negate){let n=t.long.replace(/^--no-/,"--");this._findOption(n)||this.setOptionValueWithSource(s,t.defaultValue===void 0?!0:t.defaultValue,"default")}else t.defaultValue!==void 0&&this.setOptionValueWithSource(s,t.defaultValue,"default");let i=(n,o,h)=>{n==null&&t.presetArg!==void 0&&(n=t.presetArg);let a=this.getOptionValue(s);n!==null&&t.parseArg?n=this._callParseArg(t,n,a,o):n!==null&&t.variadic&&(n=t._concatValue(n,a)),n==null&&(t.negate?n=!1:t.isBoolean()||t.optional?n=!0:n=""),this.setOptionValueWithSource(s,n,h)};return this.on("option:"+e,n=>{let o=`error: option '${t.flags}' argument '${n}' is invalid.`;i(n,o,"cli")}),t.envVar&&this.on("optionEnv:"+e,n=>{let o=`error: option '${t.flags}' value '${n}' from env '${t.envVar}' is invalid.`;i(n,o,"env")}),this}_optionEx(t,e,s,i,n){if(typeof e=="object"&&e instanceof Ke)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");let o=this.createOption(e,s);if(o.makeOptionMandatory(!!t.mandatory),typeof i=="function")o.default(n).argParser(i);else if(i instanceof RegExp){let h=i;i=(a,l)=>{let c=h.exec(a);return c?c[0]:l},o.default(n).argParser(i)}else o.default(i);return this.addOption(o)}option(t,e,s,i){return this._optionEx({},t,e,s,i)}requiredOption(t,e,s,i){return this._optionEx({mandatory:!0},t,e,s,i)}combineFlagAndOptionalValue(t=!0){return this._combineFlagAndOptionalValue=!!t,this}allowUnknownOption(t=!0){return this._allowUnknownOption=!!t,this}allowExcessArguments(t=!0){return this._allowExcessArguments=!!t,this}enablePositionalOptions(t=!0){return this._enablePositionalOptions=!!t,this}passThroughOptions(t=!0){return this._passThroughOptions=!!t,this._checkForBrokenPassThrough(),this}_checkForBrokenPassThrough(){if(this.parent&&this._passThroughOptions&&!this.parent._enablePositionalOptions)throw new Error(`passThroughOptions cannot be used for '${this._name}' without turning on enablePositionalOptions for parent command(s)`)}storeOptionsAsProperties(t=!0){if(this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");if(Object.keys(this._optionValues).length)throw new Error("call .storeOptionsAsProperties() before setting option values");return this._storeOptionsAsProperties=!!t,this}getOptionValue(t){return this._storeOptionsAsProperties?this[t]:this._optionValues[t]}setOptionValue(t,e){return this.setOptionValueWithSource(t,e,void 0)}setOptionValueWithSource(t,e,s){return this._storeOptionsAsProperties?this[t]=e:this._optionValues[t]=e,this._optionValueSources[t]=s,this}getOptionValueSource(t){return this._optionValueSources[t]}getOptionValueSourceWithGlobals(t){let e;return this._getCommandAndAncestors().forEach(s=>{s.getOptionValueSource(t)!==void 0&&(e=s.getOptionValueSource(t))}),e}_prepareUserArgs(t,e){if(t!==void 0&&!Array.isArray(t))throw new Error("first parameter to parse must be array or undefined");e=e||{},t===void 0&&(t=E.argv,E.versions&&E.versions.electron&&(e.from="electron")),this.rawArgs=t.slice();let s;switch(e.from){case void 0:case"node":this._scriptPath=t[1],s=t.slice(2);break;case"electron":E.defaultApp?(this._scriptPath=t[1],s=t.slice(2)):s=t.slice(1);break;case"user":s=t.slice(0);break;default:throw new Error(`unexpected parse option { from: '${e.from}' }`)}return!this._name&&this._scriptPath&&this.nameFromFilename(this._scriptPath),this._name=this._name||"program",s}parse(t,e){let s=this._prepareUserArgs(t,e);return this._parseCommand([],s),this}async parseAsync(t,e){let s=this._prepareUserArgs(t,e);return await this._parseCommand([],s),this}_executeSubCommand(t,e){e=e.slice();let s=!1,i=[".js",".ts",".tsx",".mjs",".cjs"];function n(c,u){let f=X.resolve(c,u);if(ye.existsSync(f))return f;if(i.includes(X.extname(u)))return;let d=i.find(m=>ye.existsSync(`${f}${m}`));if(d)return`${f}${d}`}this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let o=t._executableFile||`${this._name}-${t._name}`,h=this._executableDir||"";if(this._scriptPath){let c;try{c=ye.realpathSync(this._scriptPath)}catch{c=this._scriptPath}h=X.resolve(X.dirname(c),h)}if(h){let c=n(h,o);if(!c&&!t._executableFile&&this._scriptPath){let u=X.basename(this._scriptPath,X.extname(this._scriptPath));u!==this._name&&(c=n(h,`${u}-${t._name}`))}o=c||o}s=i.includes(X.extname(o));let a;E.platform!=="win32"?s?(e.unshift(o),e=Ye(E.execArgv).concat(e),a=be.spawn(E.argv[0],e,{stdio:"inherit"})):a=be.spawn(o,e,{stdio:"inherit"}):(e.unshift(o),e=Ye(E.execArgv).concat(e),a=be.spawn(E.execPath,e,{stdio:"inherit"})),a.killed||["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach(u=>{E.on(u,()=>{a.killed===!1&&a.exitCode===null&&a.kill(u)})});let l=this._exitCallback;a.on("close",(c,u)=>{c=c??1,l?l(new Se(c,"commander.executeSubCommandAsync","(close)")):E.exit(c)}),a.on("error",c=>{if(c.code==="ENOENT"){let u=h?`searched for local subcommand relative to directory '${h}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",f=`'${o}' does not exist
 - if '${t._name}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${u}`;throw new Error(f)}else if(c.code==="EACCES")throw new Error(`'${o}' not executable`);if(!l)E.exit(1);else{let u=new Se(1,"commander.executeSubCommandAsync","(error)");u.nestedError=c,l(u)}}),this.runningCommand=a}_dispatchSubcommand(t,e,s){let i=this._findCommand(t);i||this.help({error:!0});let n;return n=this._chainOrCallSubCommandHook(n,i,"preSubcommand"),n=this._chainOrCall(n,()=>{if(i._executableHandler)this._executeSubCommand(i,e.concat(s));else return i._parseCommand(e,s)}),n}_dispatchHelpCommand(t){t||this.help();let e=this._findCommand(t);return e&&!e._executableHandler&&e.help(),this._dispatchSubcommand(t,[],[this._getHelpOption()?.long??this._getHelpOption()?.short??"--help"])}_checkNumberOfArguments(){this.registeredArguments.forEach((t,e)=>{t.required&&this.args[e]==null&&this.missingArgument(t.name())}),!(this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic)&&this.args.length>this.registeredArguments.length&&this._excessArguments(this.args)}_processArguments(){let t=(s,i,n)=>{let o=i;if(i!==null&&s.parseArg){let h=`error: command-argument value '${i}' is invalid for argument '${s.name()}'.`;o=this._callParseArg(s,i,n,h)}return o};this._checkNumberOfArguments();let e=[];this.registeredArguments.forEach((s,i)=>{let n=s.defaultValue;s.variadic?i<this.args.length?(n=this.args.slice(i),s.parseArg&&(n=n.reduce((o,h)=>t(s,h,o),s.defaultValue))):n===void 0&&(n=[]):i<this.args.length&&(n=this.args[i],s.parseArg&&(n=t(s,n,s.defaultValue))),e[i]=n}),this.processedArgs=e}_chainOrCall(t,e){return t&&t.then&&typeof t.then=="function"?t.then(()=>e()):e()}_chainOrCallHooks(t,e){let s=t,i=[];return this._getCommandAndAncestors().reverse().filter(n=>n._lifeCycleHooks[e]!==void 0).forEach(n=>{n._lifeCycleHooks[e].forEach(o=>{i.push({hookedCommand:n,callback:o})})}),e==="postAction"&&i.reverse(),i.forEach(n=>{s=this._chainOrCall(s,()=>n.callback(n.hookedCommand,this))}),s}_chainOrCallSubCommandHook(t,e,s){let i=t;return this._lifeCycleHooks[s]!==void 0&&this._lifeCycleHooks[s].forEach(n=>{i=this._chainOrCall(i,()=>n(this,e))}),i}_parseCommand(t,e){let s=this.parseOptions(e);if(this._parseOptionsEnv(),this._parseOptionsImplied(),t=t.concat(s.operands),e=s.unknown,this.args=t.concat(e),t&&this._findCommand(t[0]))return this._dispatchSubcommand(t[0],t.slice(1),e);if(this._getHelpCommand()&&t[0]===this._getHelpCommand().name())return this._dispatchHelpCommand(t[1]);if(this._defaultCommandName)return this._outputHelpIfRequested(e),this._dispatchSubcommand(this._defaultCommandName,t,e);this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName&&this.help({error:!0}),this._outputHelpIfRequested(s.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let i=()=>{s.unknown.length>0&&this.unknownOption(s.unknown[0])},n=`command:${this.name()}`;if(this._actionHandler){i(),this._processArguments();let o;return o=this._chainOrCallHooks(o,"preAction"),o=this._chainOrCall(o,()=>this._actionHandler(this.processedArgs)),this.parent&&(o=this._chainOrCall(o,()=>{this.parent.emit(n,t,e)})),o=this._chainOrCallHooks(o,"postAction"),o}if(this.parent&&this.parent.listenerCount(n))i(),this._processArguments(),this.parent.emit(n,t,e);else if(t.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",t,e);this.listenerCount("command:*")?this.emit("command:*",t,e):this.commands.length?this.unknownCommand():(i(),this._processArguments())}else this.commands.length?(i(),this.help({error:!0})):(i(),this._processArguments())}_findCommand(t){if(t)return this.commands.find(e=>e._name===t||e._aliases.includes(t))}_findOption(t){return this.options.find(e=>e.is(t))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach(t=>{t.options.forEach(e=>{e.mandatory&&t.getOptionValue(e.attributeName())===void 0&&t.missingMandatoryOptionValue(e)})})}_checkForConflictingLocalOptions(){let t=this.options.filter(s=>{let i=s.attributeName();return this.getOptionValue(i)===void 0?!1:this.getOptionValueSource(i)!=="default"});t.filter(s=>s.conflictsWith.length>0).forEach(s=>{let i=t.find(n=>s.conflictsWith.includes(n.attributeName()));i&&this._conflictingOption(s,i)})}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach(t=>{t._checkForConflictingLocalOptions()})}parseOptions(t){let e=[],s=[],i=e,n=t.slice();function o(a){return a.length>1&&a[0]==="-"}let h=null;for(;n.length;){let a=n.shift();if(a==="--"){i===s&&i.push(a),i.push(...n);break}if(h&&!o(a)){this.emit(`option:${h.name()}`,a);continue}if(h=null,o(a)){let l=this._findOption(a);if(l){if(l.required){let c=n.shift();c===void 0&&this.optionMissingArgument(l),this.emit(`option:${l.name()}`,c)}else if(l.optional){let c=null;n.length>0&&!o(n[0])&&(c=n.shift()),this.emit(`option:${l.name()}`,c)}else this.emit(`option:${l.name()}`);h=l.variadic?l:null;continue}}if(a.length>2&&a[0]==="-"&&a[1]!=="-"){let l=this._findOption(`-${a[1]}`);if(l){l.required||l.optional&&this._combineFlagAndOptionalValue?this.emit(`option:${l.name()}`,a.slice(2)):(this.emit(`option:${l.name()}`),n.unshift(`-${a.slice(2)}`));continue}}if(/^--[^=]+=/.test(a)){let l=a.indexOf("="),c=this._findOption(a.slice(0,l));if(c&&(c.required||c.optional)){this.emit(`option:${c.name()}`,a.slice(l+1));continue}}if(o(a)&&(i=s),(this._enablePositionalOptions||this._passThroughOptions)&&e.length===0&&s.length===0){if(this._findCommand(a)){e.push(a),n.length>0&&s.push(...n);break}else if(this._getHelpCommand()&&a===this._getHelpCommand().name()){e.push(a),n.length>0&&e.push(...n);break}else if(this._defaultCommandName){s.push(a),n.length>0&&s.push(...n);break}}if(this._passThroughOptions){i.push(a),n.length>0&&i.push(...n);break}i.push(a)}return{operands:e,unknown:s}}opts(){if(this._storeOptionsAsProperties){let t={},e=this.options.length;for(let s=0;s<e;s++){let i=this.options[s].attributeName();t[i]=i===this._versionOptionName?this._version:this[i]}return t}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce((t,e)=>Object.assign(t,e.opts()),{})}error(t,e){this._outputConfiguration.outputError(`${t}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError=="string"?this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`):this._showHelpAfterError&&(this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0}));let s=e||{},i=s.exitCode||1,n=s.code||"commander.error";this._exit(i,n,t)}_parseOptionsEnv(){this.options.forEach(t=>{if(t.envVar&&t.envVar in E.env){let e=t.attributeName();(this.getOptionValue(e)===void 0||["default","config","env"].includes(this.getOptionValueSource(e)))&&(t.required||t.optional?this.emit(`optionEnv:${t.name()}`,E.env[t.envVar]):this.emit(`optionEnv:${t.name()}`))}})}_parseOptionsImplied(){let t=new Pi(this.options),e=s=>this.getOptionValue(s)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(s));this.options.filter(s=>s.implied!==void 0&&e(s.attributeName())&&t.valueFromOption(this.getOptionValue(s.attributeName()),s)).forEach(s=>{Object.keys(s.implied).filter(i=>!e(i)).forEach(i=>{this.setOptionValueWithSource(i,s.implied[i],"implied")})})}missingArgument(t){let e=`error: missing required argument '${t}'`;this.error(e,{code:"commander.missingArgument"})}optionMissingArgument(t){let e=`error: option '${t.flags}' argument missing`;this.error(e,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(t){let e=`error: required option '${t.flags}' not specified`;this.error(e,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(t,e){let s=o=>{let h=o.attributeName(),a=this.getOptionValue(h),l=this.options.find(u=>u.negate&&h===u.attributeName()),c=this.options.find(u=>!u.negate&&h===u.attributeName());return l&&(l.presetArg===void 0&&a===!1||l.presetArg!==void 0&&a===l.presetArg)?l:c||o},i=o=>{let h=s(o),a=h.attributeName();return this.getOptionValueSource(a)==="env"?`environment variable '${h.envVar}'`:`option '${h.flags}'`},n=`error: ${i(t)} cannot be used with ${i(e)}`;this.error(n,{code:"commander.conflictingOption"})}unknownOption(t){if(this._allowUnknownOption)return;let e="";if(t.startsWith("--")&&this._showSuggestionAfterError){let i=[],n=this;do{let o=n.createHelp().visibleOptions(n).filter(h=>h.long).map(h=>h.long);i=i.concat(o),n=n.parent}while(n&&!n._enablePositionalOptions);e=Je(t,i)}let s=`error: unknown option '${t}'${e}`;this.error(s,{code:"commander.unknownOption"})}_excessArguments(t){if(this._allowExcessArguments)return;let e=this.registeredArguments.length,s=e===1?"":"s",n=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${e} argument${s} but got ${t.length}.`;this.error(n,{code:"commander.excessArguments"})}unknownCommand(){let t=this.args[0],e="";if(this._showSuggestionAfterError){let i=[];this.createHelp().visibleCommands(this).forEach(n=>{i.push(n.name()),n.alias()&&i.push(n.alias())}),e=Je(t,i)}let s=`error: unknown command '${t}'${e}`;this.error(s,{code:"commander.unknownCommand"})}version(t,e,s){if(t===void 0)return this._version;this._version=t,e=e||"-V, --version",s=s||"output the version number";let i=this.createOption(e,s);return this._versionOptionName=i.attributeName(),this._registerOption(i),this.on("option:"+i.name(),()=>{this._outputConfiguration.writeOut(`${t}
`),this._exit(0,"commander.version",t)}),this}description(t,e){return t===void 0&&e===void 0?this._description:(this._description=t,e&&(this._argsDescription=e),this)}summary(t){return t===void 0?this._summary:(this._summary=t,this)}alias(t){if(t===void 0)return this._aliases[0];let e=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler&&(e=this.commands[this.commands.length-1]),t===e._name)throw new Error("Command alias can't be the same as its name");let s=this.parent?._findCommand(t);if(s){let i=[s.name()].concat(s.aliases()).join("|");throw new Error(`cannot add alias '${t}' to command '${this.name()}' as already have command '${i}'`)}return e._aliases.push(t),this}aliases(t){return t===void 0?this._aliases:(t.forEach(e=>this.alias(e)),this)}usage(t){if(t===void 0){if(this._usage)return this._usage;let e=this.registeredArguments.map(s=>Li(s));return[].concat(this.options.length||this._helpOption!==null?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?e:[]).join(" ")}return this._usage=t,this}name(t){return t===void 0?this._name:(this._name=t,this)}nameFromFilename(t){return this._name=X.basename(t,X.extname(t)),this}executableDir(t){return t===void 0?this._executableDir:(this._executableDir=t,this)}helpInformation(t){let e=this.createHelp();return e.helpWidth===void 0&&(e.helpWidth=t&&t.error?this._outputConfiguration.getErrHelpWidth():this._outputConfiguration.getOutHelpWidth()),e.formatHelp(this,e)}_getHelpContext(t){t=t||{};let e={error:!!t.error},s;return e.error?s=i=>this._outputConfiguration.writeErr(i):s=i=>this._outputConfiguration.writeOut(i),e.write=t.write||s,e.command=this,e}outputHelp(t){let e;typeof t=="function"&&(e=t,t=void 0);let s=this._getHelpContext(t);this._getCommandAndAncestors().reverse().forEach(n=>n.emit("beforeAllHelp",s)),this.emit("beforeHelp",s);let i=this.helpInformation(s);if(e&&(i=e(i),typeof i!="string"&&!Buffer.isBuffer(i)))throw new Error("outputHelp callback must return a string or a Buffer");s.write(i),this._getHelpOption()?.long&&this.emit(this._getHelpOption().long),this.emit("afterHelp",s),this._getCommandAndAncestors().forEach(n=>n.emit("afterAllHelp",s))}helpOption(t,e){return typeof t=="boolean"?(t?this._helpOption=this._helpOption??void 0:this._helpOption=null,this):(t=t??"-h, --help",e=e??"display help for command",this._helpOption=this.createOption(t,e),this)}_getHelpOption(){return this._helpOption===void 0&&this.helpOption(void 0,void 0),this._helpOption}addHelpOption(t){return this._helpOption=t,this}help(t){this.outputHelp(t);let e=E.exitCode||0;e===0&&t&&typeof t!="function"&&t.error&&(e=1),this._exit(e,"commander.help","(outputHelp)")}addHelpText(t,e){let s=["beforeAll","before","after","afterAll"];if(!s.includes(t))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${s.join("', '")}'`);let i=`${t}Help`;return this.on(i,n=>{let o;typeof e=="function"?o=e({error:n.error,command:n.command}):o=e,o&&n.write(`${o}
`)}),this}_outputHelpIfRequested(t){let e=this._getHelpOption();e&&t.find(i=>e.is(i))&&(this.outputHelp(),this._exit(0,"commander.helpDisplayed","(outputHelp)"))}};function Ye(r){return r.map(t=>{if(!t.startsWith("--inspect"))return t;let e,s="127.0.0.1",i="9229",n;return(n=t.match(/^(--inspect(-brk)?)$/))!==null?e=n[1]:(n=t.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null?(e=n[1],/^\d+$/.test(n[3])?i=n[3]:s=n[3]):(n=t.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null&&(e=n[1],s=n[3],i=n[4]),e&&i!=="0"?`${e}=${s}:${parseInt(i)+1}`:t})}Xe.Command=_e});var ss=Y(I=>{var{Argument:Qe}=Vt(),{Command:Ee}=Ze(),{CommanderError:Vi,InvalidArgumentError:ts}=yt(),{Help:Wi}=de(),{Option:es}=we();I.program=new Ee;I.createCommand=r=>new Ee(r);I.createOption=(r,t)=>new es(r,t);I.createArgument=(r,t)=>new Qe(r,t);I.Command=Ee;I.Option=es;I.Argument=Qe;I.Help=Wi;I.CommanderError=Vi;I.InvalidArgumentError=ts;I.InvalidOptionArgumentError=ts});var Ss=Y((Vr,ys)=>{"use strict";ys.exports=ws;function ws(r,t,e){r instanceof RegExp&&(r=gs(r,e)),t instanceof RegExp&&(t=gs(t,e));var s=bs(r,t,e);return s&&{start:s[0],end:s[1],pre:e.slice(0,s[0]),body:e.slice(s[0]+r.length,s[1]),post:e.slice(s[1]+t.length)}}function gs(r,t){var e=t.match(r);return e?e[0]:null}ws.range=bs;function bs(r,t,e){var s,i,n,o,h,a=e.indexOf(r),l=e.indexOf(t,a+1),c=a;if(a>=0&&l>0){if(r===t)return[a,l];for(s=[],n=e.length;c>=0&&!h;)c==a?(s.push(c),a=e.indexOf(r,c+1)):s.length==1?h=[s.pop(),l]:(i=s.pop(),i<n&&(n=i,o=l),l=e.indexOf(t,c+1)),c=a<l&&a>=0?a:l;s.length&&(h=[n,o])}return h}});var Hs=Y((Wr,Os)=>{var _s=Ss();Os.exports=Ui;var Es="\0SLASH"+Math.random()+"\0",As="\0OPEN"+Math.random()+"\0",Ce="\0CLOSE"+Math.random()+"\0",Cs="\0COMMA"+Math.random()+"\0",xs="\0PERIOD"+Math.random()+"\0";function Ae(r){return parseInt(r,10)==r?parseInt(r,10):r.charCodeAt(0)}function Bi(r){return r.split("\\\\").join(Es).split("\\{").join(As).split("\\}").join(Ce).split("\\,").join(Cs).split("\\.").join(xs)}function zi(r){return r.split(Es).join("\\").split(As).join("{").split(Ce).join("}").split(Cs).join(",").split(xs).join(".")}function vs(r){if(!r)return[""];var t=[],e=_s("{","}",r);if(!e)return r.split(",");var s=e.pre,i=e.body,n=e.post,o=s.split(",");o[o.length-1]+="{"+i+"}";var h=vs(n);return n.length&&(o[o.length-1]+=h.shift(),o.push.apply(o,h)),t.push.apply(t,o),t}function Ui(r){return r?(r.substr(0,2)==="{}"&&(r="\\{\\}"+r.substr(2)),_t(Bi(r),!0).map(zi)):[]}function Gi(r){return"{"+r+"}"}function qi(r){return/^-?0\d/.test(r)}function Ki(r,t){return r<=t}function Ji(r,t){return r>=t}function _t(r,t){var e=[],s=_s("{","}",r);if(!s)return[r];var i=s.pre,n=s.post.length?_t(s.post,!1):[""];if(/\$$/.test(s.pre))for(var o=0;o<n.length;o++){var h=i+"{"+s.body+"}"+n[o];e.push(h)}else{var a=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(s.body),l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(s.body),c=a||l,u=s.body.indexOf(",")>=0;if(!c&&!u)return s.post.match(/,.*\}/)?(r=s.pre+"{"+s.body+Ce+s.post,_t(r)):[r];var f;if(c)f=s.body.split(/\.\./);else if(f=vs(s.body),f.length===1&&(f=_t(f[0],!1).map(Gi),f.length===1))return n.map(function(jt){return s.pre+f[0]+jt});var d;if(c){var m=Ae(f[0]),p=Ae(f[1]),w=Math.max(f[0].length,f[1].length),g=f.length==3?Math.abs(Ae(f[2])):1,S=Ki,y=p<m;y&&(g*=-1,S=Ji);var b=f.some(qi);d=[];for(var _=m;S(_,p);_+=g){var x;if(l)x=String.fromCharCode(_),x==="\\"&&(x="");else if(x=String(_),b){var V=w-x.length;if(V>0){var Lt=new Array(V+1).join("0");_<0?x="-"+Lt+x.slice(1):x=Lt+x}}d.push(x)}}else{d=[];for(var G=0;G<f.length;G++)d.push.apply(d,_t(f[G],!1))}for(var G=0;G<d.length;G++)for(var o=0;o<n.length;o++){var h=i+d[G]+n[o];(!t||c||h)&&e.push(h)}}return e}});var Si=bt(require("process"));var is=bt(ss(),1),{program:Or,createCommand:Hr,createArgument:Fr,createOption:kr,CommanderError:Tr,InvalidArgumentError:$r,InvalidOptionArgumentError:Rr,Command:ns,Argument:Dr,Option:Nr,Help:Ir}=is.default;function rs(r){return{debug:t=>{r.opts().debug},info:t=>{},warning:t=>{},error:t=>{},setFailed:t=>{process.exit(1)}}}function os(r){return{eligible:()=>{},result:t=>{if(t.valid!==!0){let e=`Hash check failed: ${t.file}; ${t.reason}`;r.opts().strict}},failure:t=>{let e=`Hash check failed: ${t.reason}; ${t.message}`;r.opts().strict}}}var as={md5:32,sha1:40,sha256:64,sha512:128},hs={32:"md5",40:"sha1",64:"sha256",128:"sha512"},ls={md5:24,sha1:28,sha256:44,sha512:88},cs={24:"md5",28:"sha1",44:"sha256",88:"sha512"},us=/^[a-fA-F0-9]+$/,fs=/^[a-zA-Z0-9/+]+={0,2}$/,ds={md5:"md5",sha1:"sha1",sha256:"sha256",sha512:"sha512",sha:"sha1"},St=["md5","sha1","sha256","sha512"];var C=require("path"),bi=require("fs"),We=require("fs/promises");var ps=require("crypto");async function ms(r,t,e){return(0,ps.createHash)(r).update(e).digest(t)}var Is=bt(Hs(),1);var Et=r=>{if(typeof r!="string")throw new TypeError("invalid pattern");if(r.length>65536)throw new TypeError("pattern is too long")};var Yi={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},At=r=>r.replace(/[[\]\\-]/g,"\\$&"),Xi=r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),Fs=r=>r.join(""),ks=(r,t)=>{let e=t;if(r.charAt(e)!=="[")throw new Error("not in a brace expression");let s=[],i=[],n=e+1,o=!1,h=!1,a=!1,l=!1,c=e,u="";t:for(;n<r.length;){let p=r.charAt(n);if((p==="!"||p==="^")&&n===e+1){l=!0,n++;continue}if(p==="]"&&o&&!a){c=n+1;break}if(o=!0,p==="\\"&&!a){a=!0,n++;continue}if(p==="["&&!a){for(let[w,[g,S,y]]of Object.entries(Yi))if(r.startsWith(w,n)){if(u)return["$.",!1,r.length-e,!0];n+=w.length,y?i.push(g):s.push(g),h=h||S;continue t}}if(a=!1,u){p>u?s.push(At(u)+"-"+At(p)):p===u&&s.push(At(p)),u="",n++;continue}if(r.startsWith("-]",n+1)){s.push(At(p+"-")),n+=2;continue}if(r.startsWith("-",n+1)){u=p,n+=2;continue}s.push(At(p)),n++}if(c<n)return["",!1,0,!1];if(!s.length&&!i.length)return["$.",!1,r.length-e,!0];if(i.length===0&&s.length===1&&/^\\?.$/.test(s[0])&&!l){let p=s[0].length===2?s[0].slice(-1):s[0];return[Xi(p),!1,c-e,!1]}let f="["+(l?"^":"")+Fs(s)+"]",d="["+(l?"":"^")+Fs(i)+"]";return[s.length&&i.length?"("+f+"|"+d+")":s.length?f:d,h,c-e,!0]};var W=(r,{windowsPathsNoEscape:t=!1}={})=>t?r.replace(/\[([^\/\\])\]/g,"$1"):r.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1");var Zi=new Set(["!","?","+","*","@"]),Ts=r=>Zi.has(r),Qi="(?!(?:^|/)\\.\\.?(?:$|/))",Wt="(?!\\.)",tn=new Set(["[","."]),en=new Set(["..","."]),sn=new Set("().*{}+?[]^$\\!"),nn=r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),xe="[^/]",$s=xe+"*?",Rs=xe+"+?",ht=class r{type;#t;#s;#r=!1;#i=[];#a;#l;#u;#h=!1;#o;#e;#m=!1;constructor(t,e,s={}){this.type=t,t&&(this.#s=!0),this.#a=e,this.#t=this.#a?this.#a.#t:this,this.#o=this.#t===this?s:this.#t.#o,this.#u=this.#t===this?[]:this.#t.#u,t==="!"&&!this.#t.#h&&this.#u.push(this),this.#l=this.#a?this.#a.#i.length:0}get hasMagic(){if(this.#s!==void 0)return this.#s;for(let t of this.#i)if(typeof t!="string"&&(t.type||t.hasMagic))return this.#s=!0;return this.#s}toString(){return this.#e!==void 0?this.#e:this.type?this.#e=this.type+"("+this.#i.map(t=>String(t)).join("|")+")":this.#e=this.#i.map(t=>String(t)).join("")}#w(){if(this!==this.#t)throw new Error("should only call on root");if(this.#h)return this;this.toString(),this.#h=!0;let t;for(;t=this.#u.pop();){if(t.type!=="!")continue;let e=t,s=e.#a;for(;s;){for(let i=e.#l+1;!s.type&&i<s.#i.length;i++)for(let n of t.#i){if(typeof n=="string")throw new Error("string part in extglob AST??");n.copyIn(s.#i[i])}e=s,s=e.#a}}return this}push(...t){for(let e of t)if(e!==""){if(typeof e!="string"&&!(e instanceof r&&e.#a===this))throw new Error("invalid part: "+e);this.#i.push(e)}}toJSON(){let t=this.type===null?this.#i.slice().map(e=>typeof e=="string"?e:e.toJSON()):[this.type,...this.#i.map(e=>e.toJSON())];return this.isStart()&&!this.type&&t.unshift([]),this.isEnd()&&(this===this.#t||this.#t.#h&&this.#a?.type==="!")&&t.push({}),t}isStart(){if(this.#t===this)return!0;if(!this.#a?.isStart())return!1;if(this.#l===0)return!0;let t=this.#a;for(let e=0;e<this.#l;e++){let s=t.#i[e];if(!(s instanceof r&&s.type==="!"))return!1}return!0}isEnd(){if(this.#t===this||this.#a?.type==="!")return!0;if(!this.#a?.isEnd())return!1;if(!this.type)return this.#a?.isEnd();let t=this.#a?this.#a.#i.length:0;return this.#l===t-1}copyIn(t){typeof t=="string"?this.push(t):this.push(t.clone(this))}clone(t){let e=new r(this.type,t);for(let s of this.#i)e.copyIn(s);return e}static#d(t,e,s,i){let n=!1,o=!1,h=-1,a=!1;if(e.type===null){let d=s,m="";for(;d<t.length;){let p=t.charAt(d++);if(n||p==="\\"){n=!n,m+=p;continue}if(o){d===h+1?(p==="^"||p==="!")&&(a=!0):p==="]"&&!(d===h+2&&a)&&(o=!1),m+=p;continue}else if(p==="["){o=!0,h=d,a=!1,m+=p;continue}if(!i.noext&&Ts(p)&&t.charAt(d)==="("){e.push(m),m="";let w=new r(p,e);d=r.#d(t,w,d,i),e.push(w);continue}m+=p}return e.push(m),d}let l=s+1,c=new r(null,e),u=[],f="";for(;l<t.length;){let d=t.charAt(l++);if(n||d==="\\"){n=!n,f+=d;continue}if(o){l===h+1?(d==="^"||d==="!")&&(a=!0):d==="]"&&!(l===h+2&&a)&&(o=!1),f+=d;continue}else if(d==="["){o=!0,h=l,a=!1,f+=d;continue}if(Ts(d)&&t.charAt(l)==="("){c.push(f),f="";let m=new r(d,c);c.push(m),l=r.#d(t,m,l,i);continue}if(d==="|"){c.push(f),f="",u.push(c),c=new r(null,e);continue}if(d===")")return f===""&&e.#i.length===0&&(e.#m=!0),c.push(f),f="",e.push(...u,c),l;f+=d}return e.type=null,e.#s=void 0,e.#i=[t.substring(s-1)],l}static fromGlob(t,e={}){let s=new r(null,void 0,e);return r.#d(t,s,0,e),s}toMMPattern(){if(this!==this.#t)return this.#t.toMMPattern();let t=this.toString(),[e,s,i,n]=this.toRegExpSource();if(!(i||this.#s||this.#o.nocase&&!this.#o.nocaseMagicOnly&&t.toUpperCase()!==t.toLowerCase()))return s;let h=(this.#o.nocase?"i":"")+(n?"u":"");return Object.assign(new RegExp(`^${e}$`,h),{_src:e,_glob:t})}toRegExpSource(t){let e=t??!!this.#o.dot;if(this.#t===this&&this.#w(),!this.type){let a=this.isStart()&&this.isEnd(),l=this.#i.map(d=>{let[m,p,w,g]=typeof d=="string"?r.#S(d,this.#s,a):d.toRegExpSource(t);return this.#s=this.#s||w,this.#r=this.#r||g,m}).join(""),c="";if(this.isStart()&&typeof this.#i[0]=="string"&&!(this.#i.length===1&&en.has(this.#i[0]))){let m=tn,p=e&&m.has(l.charAt(0))||l.startsWith("\\.")&&m.has(l.charAt(2))||l.startsWith("\\.\\.")&&m.has(l.charAt(4)),w=!e&&!t&&m.has(l.charAt(0));c=p?Qi:w?Wt:""}let u="";return this.isEnd()&&this.#t.#h&&this.#a?.type==="!"&&(u="(?:$|\\/)"),[c+l+u,W(l),this.#s=!!this.#s,this.#r]}let s=this.type==="*"||this.type==="+",i=this.type==="!"?"(?:(?!(?:":"(?:",n=this.#f(e);if(this.isStart()&&this.isEnd()&&!n&&this.type!=="!"){let a=this.toString();return this.#i=[a],this.type=null,this.#s=void 0,[a,W(this.toString()),!1,!1]}let o=!s||t||e||!Wt?"":this.#f(!0);o===n&&(o=""),o&&(n=`(?:${n})(?:${o})*?`);let h="";if(this.type==="!"&&this.#m)h=(this.isStart()&&!e?Wt:"")+Rs;else{let a=this.type==="!"?"))"+(this.isStart()&&!e&&!t?Wt:"")+$s+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&o?")":this.type==="*"&&o?")?":`)${this.type}`;h=i+n+a}return[h,W(n),this.#s=!!this.#s,this.#r]}#f(t){return this.#i.map(e=>{if(typeof e=="string")throw new Error("string type in extglob ast??");let[s,i,n,o]=e.toRegExpSource(t);return this.#r=this.#r||o,s}).filter(e=>!(this.isStart()&&this.isEnd())||!!e).join("|")}static#S(t,e,s=!1){let i=!1,n="",o=!1;for(let h=0;h<t.length;h++){let a=t.charAt(h);if(i){i=!1,n+=(sn.has(a)?"\\":"")+a;continue}if(a==="\\"){h===t.length-1?n+="\\\\":i=!0;continue}if(a==="["){let[l,c,u,f]=ks(t,h);if(u){n+=l,o=o||c,h+=u-1,e=e||f;continue}}if(a==="*"){s&&t==="*"?n+=Rs:n+=$s,e=!0;continue}if(a==="?"){n+=xe,e=!0;continue}n+=nn(a)}return[n,W(t),!!e,o]}};var lt=(r,{windowsPathsNoEscape:t=!1}={})=>t?r.replace(/[?*()[\]]/g,"[$&]"):r.replace(/[?*()[\]\\]/g,"\\$&");var $=(r,t,e={})=>(Et(t),!e.nocomment&&t.charAt(0)==="#"?!1:new D(t,e).match(r)),rn=/^\*+([^+@!?\*\[\(]*)$/,on=r=>t=>!t.startsWith(".")&&t.endsWith(r),an=r=>t=>t.endsWith(r),hn=r=>(r=r.toLowerCase(),t=>!t.startsWith(".")&&t.toLowerCase().endsWith(r)),ln=r=>(r=r.toLowerCase(),t=>t.toLowerCase().endsWith(r)),cn=/^\*+\.\*+$/,un=r=>!r.startsWith(".")&&r.includes("."),fn=r=>r!=="."&&r!==".."&&r.includes("."),dn=/^\.\*+$/,pn=r=>r!=="."&&r!==".."&&r.startsWith("."),mn=/^\*+$/,gn=r=>r.length!==0&&!r.startsWith("."),wn=r=>r.length!==0&&r!=="."&&r!=="..",bn=/^\?+([^+@!?\*\[\(]*)?$/,yn=([r,t=""])=>{let e=Ms([r]);return t?(t=t.toLowerCase(),s=>e(s)&&s.toLowerCase().endsWith(t)):e},Sn=([r,t=""])=>{let e=Ls([r]);return t?(t=t.toLowerCase(),s=>e(s)&&s.toLowerCase().endsWith(t)):e},_n=([r,t=""])=>{let e=Ls([r]);return t?s=>e(s)&&s.endsWith(t):e},En=([r,t=""])=>{let e=Ms([r]);return t?s=>e(s)&&s.endsWith(t):e},Ms=([r])=>{let t=r.length;return e=>e.length===t&&!e.startsWith(".")},Ls=([r])=>{let t=r.length;return e=>e.length===t&&e!=="."&&e!==".."},js=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",Ds={win32:{sep:"\\"},posix:{sep:"/"}},An=js==="win32"?Ds.win32.sep:Ds.posix.sep;$.sep=An;var F=Symbol("globstar **");$.GLOBSTAR=F;var Cn="[^/]",xn=Cn+"*?",vn="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",On="(?:(?!(?:\\/|^)\\.).)*?",Hn=(r,t={})=>e=>$(e,r,t);$.filter=Hn;var M=(r,t={})=>Object.assign({},r,t),Fn=r=>{if(!r||typeof r!="object"||!Object.keys(r).length)return $;let t=$;return Object.assign((s,i,n={})=>t(s,i,M(r,n)),{Minimatch:class extends t.Minimatch{constructor(i,n={}){super(i,M(r,n))}static defaults(i){return t.defaults(M(r,i)).Minimatch}},AST:class extends t.AST{constructor(i,n,o={}){super(i,n,M(r,o))}static fromGlob(i,n={}){return t.AST.fromGlob(i,M(r,n))}},unescape:(s,i={})=>t.unescape(s,M(r,i)),escape:(s,i={})=>t.escape(s,M(r,i)),filter:(s,i={})=>t.filter(s,M(r,i)),defaults:s=>t.defaults(M(r,s)),makeRe:(s,i={})=>t.makeRe(s,M(r,i)),braceExpand:(s,i={})=>t.braceExpand(s,M(r,i)),match:(s,i,n={})=>t.match(s,i,M(r,n)),sep:t.sep,GLOBSTAR:F})};$.defaults=Fn;var Ps=(r,t={})=>(Et(r),t.nobrace||!/\{(?:(?!\{).)*\}/.test(r)?[r]:(0,Is.default)(r));$.braceExpand=Ps;var kn=(r,t={})=>new D(r,t).makeRe();$.makeRe=kn;var Tn=(r,t,e={})=>{let s=new D(t,e);return r=r.filter(i=>s.match(i)),s.options.nonull&&!r.length&&r.push(t),r};$.match=Tn;var Ns=/[?*]|[+@!]\(.*?\)|\[|\]/,$n=r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),D=class{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(t,e={}){Et(t),e=e||{},this.options=e,this.pattern=t,this.platform=e.platform||js,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!e.windowsPathsNoEscape||e.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!e.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!e.nonegate,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=e.windowsNoMagicRoot!==void 0?e.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let t of this.set)for(let e of t)if(typeof e!="string")return!0;return!1}debug(...t){}make(){let t=this.pattern,e=this.options;if(!e.nocomment&&t.charAt(0)==="#"){this.comment=!0;return}if(!t){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],e.debug&&(this.debug=(...n)=>{}),this.debug(this.pattern,this.globSet);let s=this.globSet.map(n=>this.slashSplit(n));this.globParts=this.preprocess(s),this.debug(this.pattern,this.globParts);let i=this.globParts.map((n,o,h)=>{if(this.isWindows&&this.windowsNoMagicRoot){let a=n[0]===""&&n[1]===""&&(n[2]==="?"||!Ns.test(n[2]))&&!Ns.test(n[3]),l=/^[a-z]:/i.test(n[0]);if(a)return[...n.slice(0,4),...n.slice(4).map(c=>this.parse(c))];if(l)return[n[0],...n.slice(1).map(c=>this.parse(c))]}return n.map(a=>this.parse(a))});if(this.debug(this.pattern,i),this.set=i.filter(n=>n.indexOf(!1)===-1),this.isWindows)for(let n=0;n<this.set.length;n++){let o=this.set[n];o[0]===""&&o[1]===""&&this.globParts[n][2]==="?"&&typeof o[3]=="string"&&/^[a-z]:$/i.test(o[3])&&(o[2]="?")}this.debug(this.pattern,this.set)}preprocess(t){if(this.options.noglobstar)for(let s=0;s<t.length;s++)for(let i=0;i<t[s].length;i++)t[s][i]==="**"&&(t[s][i]="*");let{optimizationLevel:e=1}=this.options;return e>=2?(t=this.firstPhasePreProcess(t),t=this.secondPhasePreProcess(t)):e>=1?t=this.levelOneOptimize(t):t=this.adjascentGlobstarOptimize(t),t}adjascentGlobstarOptimize(t){return t.map(e=>{let s=-1;for(;(s=e.indexOf("**",s+1))!==-1;){let i=s;for(;e[i+1]==="**";)i++;i!==s&&e.splice(s,i-s)}return e})}levelOneOptimize(t){return t.map(e=>(e=e.reduce((s,i)=>{let n=s[s.length-1];return i==="**"&&n==="**"?s:i===".."&&n&&n!==".."&&n!=="."&&n!=="**"?(s.pop(),s):(s.push(i),s)},[]),e.length===0?[""]:e))}levelTwoFileOptimize(t){Array.isArray(t)||(t=this.slashSplit(t));let e=!1;do{if(e=!1,!this.preserveMultipleSlashes){for(let i=1;i<t.length-1;i++){let n=t[i];i===1&&n===""&&t[0]===""||(n==="."||n==="")&&(e=!0,t.splice(i,1),i--)}t[0]==="."&&t.length===2&&(t[1]==="."||t[1]==="")&&(e=!0,t.pop())}let s=0;for(;(s=t.indexOf("..",s+1))!==-1;){let i=t[s-1];i&&i!=="."&&i!==".."&&i!=="**"&&(e=!0,t.splice(s-1,2),s-=2)}}while(e);return t.length===0?[""]:t}firstPhasePreProcess(t){let e=!1;do{e=!1;for(let s of t){let i=-1;for(;(i=s.indexOf("**",i+1))!==-1;){let o=i;for(;s[o+1]==="**";)o++;o>i&&s.splice(i+1,o-i);let h=s[i+1],a=s[i+2],l=s[i+3];if(h!==".."||!a||a==="."||a===".."||!l||l==="."||l==="..")continue;e=!0,s.splice(i,1);let c=s.slice(0);c[i]="**",t.push(c),i--}if(!this.preserveMultipleSlashes){for(let o=1;o<s.length-1;o++){let h=s[o];o===1&&h===""&&s[0]===""||(h==="."||h==="")&&(e=!0,s.splice(o,1),o--)}s[0]==="."&&s.length===2&&(s[1]==="."||s[1]==="")&&(e=!0,s.pop())}let n=0;for(;(n=s.indexOf("..",n+1))!==-1;){let o=s[n-1];if(o&&o!=="."&&o!==".."&&o!=="**"){e=!0;let a=n===1&&s[n+1]==="**"?["."]:[];s.splice(n-1,2,...a),s.length===0&&s.push(""),n-=2}}}}while(e);return t}secondPhasePreProcess(t){for(let e=0;e<t.length-1;e++)for(let s=e+1;s<t.length;s++){let i=this.partsMatch(t[e],t[s],!this.preserveMultipleSlashes);i&&(t[e]=i,t[s]=[])}return t.filter(e=>e.length)}partsMatch(t,e,s=!1){let i=0,n=0,o=[],h="";for(;i<t.length&&n<e.length;)if(t[i]===e[n])o.push(h==="b"?e[n]:t[i]),i++,n++;else if(s&&t[i]==="**"&&e[n]===t[i+1])o.push(t[i]),i++;else if(s&&e[n]==="**"&&t[i]===e[n+1])o.push(e[n]),n++;else if(t[i]==="*"&&e[n]&&(this.options.dot||!e[n].startsWith("."))&&e[n]!=="**"){if(h==="b")return!1;h="a",o.push(t[i]),i++,n++}else if(e[n]==="*"&&t[i]&&(this.options.dot||!t[i].startsWith("."))&&t[i]!=="**"){if(h==="a")return!1;h="b",o.push(e[n]),i++,n++}else return!1;return t.length===e.length&&o}parseNegate(){if(this.nonegate)return;let t=this.pattern,e=!1,s=0;for(let i=0;i<t.length&&t.charAt(i)==="!";i++)e=!e,s++;s&&(this.pattern=t.slice(s)),this.negate=e}matchOne(t,e,s=!1){let i=this.options;if(this.isWindows){let p=typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0]),w=!p&&t[0]===""&&t[1]===""&&t[2]==="?"&&/^[a-z]:$/i.test(t[3]),g=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),S=!g&&e[0]===""&&e[1]===""&&e[2]==="?"&&typeof e[3]=="string"&&/^[a-z]:$/i.test(e[3]),y=w?3:p?0:void 0,b=S?3:g?0:void 0;if(typeof y=="number"&&typeof b=="number"){let[_,x]=[t[y],e[b]];_.toLowerCase()===x.toLowerCase()&&(e[b]=_,b>y?e=e.slice(b):y>b&&(t=t.slice(y)))}}let{optimizationLevel:n=1}=this.options;n>=2&&(t=this.levelTwoFileOptimize(t)),this.debug("matchOne",this,{file:t,pattern:e}),this.debug("matchOne",t.length,e.length);for(var o=0,h=0,a=t.length,l=e.length;o<a&&h<l;o++,h++){this.debug("matchOne loop");var c=e[h],u=t[o];if(this.debug(e,c,u),c===!1)return!1;if(c===F){this.debug("GLOBSTAR",[e,c,u]);var f=o,d=h+1;if(d===l){for(this.debug("** at the end");o<a;o++)if(t[o]==="."||t[o]===".."||!i.dot&&t[o].charAt(0)===".")return!1;return!0}for(;f<a;){var m=t[f];if(this.debug(`
globstar while`,t,f,e,d,m),this.matchOne(t.slice(f),e.slice(d),s))return this.debug("globstar found match!",f,a,m),!0;if(m==="."||m===".."||!i.dot&&m.charAt(0)==="."){this.debug("dot detected!",t,f,e,d);break}this.debug("globstar swallow a segment, and continue"),f++}return!!(s&&(this.debug(`
>>> no match, partial?`,t,f,e,d),f===a))}let p;if(typeof c=="string"?(p=u===c,this.debug("string match",c,u,p)):(p=c.test(u),this.debug("pattern match",c,u,p)),!p)return!1}if(o===a&&h===l)return!0;if(o===a)return s;if(h===l)return o===a-1&&t[o]==="";throw new Error("wtf?")}braceExpand(){return Ps(this.pattern,this.options)}parse(t){Et(t);let e=this.options;if(t==="**")return F;if(t==="")return"";let s,i=null;(s=t.match(mn))?i=e.dot?wn:gn:(s=t.match(rn))?i=(e.nocase?e.dot?ln:hn:e.dot?an:on)(s[1]):(s=t.match(bn))?i=(e.nocase?e.dot?Sn:yn:e.dot?_n:En)(s):(s=t.match(cn))?i=e.dot?fn:un:(s=t.match(dn))&&(i=pn);let n=ht.fromGlob(t,this.options).toMMPattern();return i?Object.assign(n,{test:i}):n}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let t=this.set;if(!t.length)return this.regexp=!1,this.regexp;let e=this.options,s=e.noglobstar?xn:e.dot?vn:On,i=new Set(e.nocase?["i"]:[]),n=t.map(a=>{let l=a.map(c=>{if(c instanceof RegExp)for(let u of c.flags.split(""))i.add(u);return typeof c=="string"?$n(c):c===F?F:c._src});return l.forEach((c,u)=>{let f=l[u+1],d=l[u-1];c!==F||d===F||(d===void 0?f!==void 0&&f!==F?l[u+1]="(?:\\/|"+s+"\\/)?"+f:l[u]=s:f===void 0?l[u-1]=d+"(?:\\/|"+s+")?":f!==F&&(l[u-1]=d+"(?:\\/|\\/"+s+"\\/)"+f,l[u+1]=F))}),l.filter(c=>c!==F).join("/")}).join("|"),[o,h]=t.length>1?["(?:",")"]:["",""];n="^"+o+n+h+"$",this.negate&&(n="^(?!"+n+").+$");try{this.regexp=new RegExp(n,[...i].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(t){return this.preserveMultipleSlashes?t.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(t)?["",...t.split(/\/+/)]:t.split(/\/+/)}match(t,e=this.partial){if(this.debug("match",t,this.pattern),this.comment)return!1;if(this.empty)return t==="";if(t==="/"&&e)return!0;let s=this.options;this.isWindows&&(t=t.split("\\").join("/"));let i=this.slashSplit(t);this.debug(this.pattern,"split",i);let n=this.set;this.debug(this.pattern,"set",n);let o=i[i.length-1];if(!o)for(let h=i.length-2;!o&&h>=0;h--)o=i[h];for(let h=0;h<n.length;h++){let a=n[h],l=i;if(s.matchBase&&a.length===1&&(l=[o]),this.matchOne(l,a,e))return s.flipNegate?!0:!this.negate}return s.flipNegate?!1:this.negate}static defaults(t){return $.defaults(t).Minimatch}};$.AST=ht;$.Minimatch=D;$.escape=lt;$.unescape=W;var ct=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Ws=new Set,ve=typeof process=="object"&&process?process:{},Bs=(r,t,e,s)=>{typeof ve.emitWarning=="function"&&ve.emitWarning(r,t,e,s)},Bt=globalThis.AbortController,Vs=globalThis.AbortSignal;if(typeof Bt>"u"){Vs=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(s,i){this._onabort.push(i)}},Bt=class{constructor(){t()}signal=new Vs;abort(s){if(!this.signal.aborted){this.signal.reason=s,this.signal.aborted=!0;for(let i of this.signal._onabort)i(s);this.signal.onabort?.(s)}}};let r=ve.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",t=()=>{r&&(r=!1,Bs("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}var Rn=r=>!Ws.has(r),ho=Symbol("type"),tt=r=>r&&r===Math.floor(r)&&r>0&&isFinite(r),zs=r=>tt(r)?r<=Math.pow(2,8)?Uint8Array:r<=Math.pow(2,16)?Uint16Array:r<=Math.pow(2,32)?Uint32Array:r<=Number.MAX_SAFE_INTEGER?ut:null:null,ut=class extends Array{constructor(t){super(t),this.fill(0)}},Oe=class r{heap;length;static#t=!1;static create(t){let e=zs(t);if(!e)return[];r.#t=!0;let s=new r(t,e);return r.#t=!1,s}constructor(t,e){if(!r.#t)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new e(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}},Ct=class r{#t;#s;#r;#i;#a;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#l;#u;#h;#o;#e;#m;#w;#d;#f;#S;#g;#x;#v;#_;#y;#H;#p;static unsafeExposeInternals(t){return{starts:t.#v,ttls:t.#_,sizes:t.#x,keyMap:t.#h,keyList:t.#o,valList:t.#e,next:t.#m,prev:t.#w,get head(){return t.#d},get tail(){return t.#f},free:t.#S,isBackgroundFetch:e=>t.#c(e),backgroundFetch:(e,s,i,n)=>t.#D(e,s,i,n),moveToTail:e=>t.#R(e),indexes:e=>t.#C(e),rindexes:e=>t.#F(e),isStale:e=>t.#b(e)}}get max(){return this.#t}get maxSize(){return this.#s}get calculatedSize(){return this.#u}get size(){return this.#l}get fetchMethod(){return this.#a}get dispose(){return this.#r}get disposeAfter(){return this.#i}constructor(t){let{max:e=0,ttl:s,ttlResolution:i=1,ttlAutopurge:n,updateAgeOnGet:o,updateAgeOnHas:h,allowStale:a,dispose:l,disposeAfter:c,noDisposeOnSet:u,noUpdateTTL:f,maxSize:d=0,maxEntrySize:m=0,sizeCalculation:p,fetchMethod:w,noDeleteOnFetchRejection:g,noDeleteOnStaleGet:S,allowStaleOnFetchRejection:y,allowStaleOnFetchAbort:b,ignoreFetchAbort:_}=t;if(e!==0&&!tt(e))throw new TypeError("max option must be a nonnegative integer");let x=e?zs(e):Array;if(!x)throw new Error("invalid max value: "+e);if(this.#t=e,this.#s=d,this.maxEntrySize=m||this.#s,this.sizeCalculation=p,this.sizeCalculation){if(!this.#s&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(w!==void 0&&typeof w!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#a=w,this.#H=!!w,this.#h=new Map,this.#o=new Array(e).fill(void 0),this.#e=new Array(e).fill(void 0),this.#m=new x(e),this.#w=new x(e),this.#d=0,this.#f=0,this.#S=Oe.create(e),this.#l=0,this.#u=0,typeof l=="function"&&(this.#r=l),typeof c=="function"?(this.#i=c,this.#g=[]):(this.#i=void 0,this.#g=void 0),this.#y=!!this.#r,this.#p=!!this.#i,this.noDisposeOnSet=!!u,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!g,this.allowStaleOnFetchRejection=!!y,this.allowStaleOnFetchAbort=!!b,this.ignoreFetchAbort=!!_,this.maxEntrySize!==0){if(this.#s!==0&&!tt(this.#s))throw new TypeError("maxSize must be a positive integer if specified");if(!tt(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#T()}if(this.allowStale=!!a,this.noDeleteOnStaleGet=!!S,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!h,this.ttlResolution=tt(i)||i===0?i:1,this.ttlAutopurge=!!n,this.ttl=s||0,this.ttl){if(!tt(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#k()}if(this.#t===0&&this.ttl===0&&this.#s===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#t&&!this.#s){let V="LRU_CACHE_UNBOUNDED";Rn(V)&&(Ws.add(V),Bs("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",V,r))}}getRemainingTTL(t){return this.#h.has(t)?1/0:0}#k(){let t=new ut(this.#t),e=new ut(this.#t);this.#_=t,this.#v=e,this.#n=(n,o,h=ct.now())=>{if(e[n]=o!==0?h:0,t[n]=o,o!==0&&this.ttlAutopurge){let a=setTimeout(()=>{this.#b(n)&&this.delete(this.#o[n])},o+1);a.unref&&a.unref()}},this.#O=n=>{e[n]=t[n]!==0?ct.now():0},this.#E=(n,o)=>{if(t[o]){let h=t[o],a=e[o];if(!h||!a)return;n.ttl=h,n.start=a,n.now=s||i();let l=n.now-a;n.remainingTTL=h-l}};let s=0,i=()=>{let n=ct.now();if(this.ttlResolution>0){s=n;let o=setTimeout(()=>s=0,this.ttlResolution);o.unref&&o.unref()}return n};this.getRemainingTTL=n=>{let o=this.#h.get(n);if(o===void 0)return 0;let h=t[o],a=e[o];if(!h||!a)return 1/0;let l=(s||i())-a;return h-l},this.#b=n=>{let o=e[n],h=t[n];return!!h&&!!o&&(s||i())-o>h}}#O=()=>{};#E=()=>{};#n=()=>{};#b=()=>!1;#T(){let t=new ut(this.#t);this.#u=0,this.#x=t,this.#A=e=>{this.#u-=t[e],t[e]=0},this.#I=(e,s,i,n)=>{if(this.#c(s))return 0;if(!tt(i))if(n){if(typeof n!="function")throw new TypeError("sizeCalculation must be a function");if(i=n(s,e),!tt(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i},this.#N=(e,s,i)=>{if(t[e]=s,this.#s){let n=this.#s-t[e];for(;this.#u>n;)this.#$(!0)}this.#u+=t[e],i&&(i.entrySize=s,i.totalCalculatedSize=this.#u)}}#A=t=>{};#N=(t,e,s)=>{};#I=(t,e,s,i)=>{if(s||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#C({allowStale:t=this.allowStale}={}){if(this.#l)for(let e=this.#f;!(!this.#M(e)||((t||!this.#b(e))&&(yield e),e===this.#d));)e=this.#w[e]}*#F({allowStale:t=this.allowStale}={}){if(this.#l)for(let e=this.#d;!(!this.#M(e)||((t||!this.#b(e))&&(yield e),e===this.#f));)e=this.#m[e]}#M(t){return t!==void 0&&this.#h.get(this.#o[t])===t}*entries(){for(let t of this.#C())this.#e[t]!==void 0&&this.#o[t]!==void 0&&!this.#c(this.#e[t])&&(yield[this.#o[t],this.#e[t]])}*rentries(){for(let t of this.#F())this.#e[t]!==void 0&&this.#o[t]!==void 0&&!this.#c(this.#e[t])&&(yield[this.#o[t],this.#e[t]])}*keys(){for(let t of this.#C()){let e=this.#o[t];e!==void 0&&!this.#c(this.#e[t])&&(yield e)}}*rkeys(){for(let t of this.#F()){let e=this.#o[t];e!==void 0&&!this.#c(this.#e[t])&&(yield e)}}*values(){for(let t of this.#C())this.#e[t]!==void 0&&!this.#c(this.#e[t])&&(yield this.#e[t])}*rvalues(){for(let t of this.#F())this.#e[t]!==void 0&&!this.#c(this.#e[t])&&(yield this.#e[t])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(t,e={}){for(let s of this.#C()){let i=this.#e[s],n=this.#c(i)?i.__staleWhileFetching:i;if(n!==void 0&&t(n,this.#o[s],this))return this.get(this.#o[s],e)}}forEach(t,e=this){for(let s of this.#C()){let i=this.#e[s],n=this.#c(i)?i.__staleWhileFetching:i;n!==void 0&&t.call(e,n,this.#o[s],this)}}rforEach(t,e=this){for(let s of this.#F()){let i=this.#e[s],n=this.#c(i)?i.__staleWhileFetching:i;n!==void 0&&t.call(e,n,this.#o[s],this)}}purgeStale(){let t=!1;for(let e of this.#F({allowStale:!0}))this.#b(e)&&(this.delete(this.#o[e]),t=!0);return t}info(t){let e=this.#h.get(t);if(e===void 0)return;let s=this.#e[e],i=this.#c(s)?s.__staleWhileFetching:s;if(i===void 0)return;let n={value:i};if(this.#_&&this.#v){let o=this.#_[e],h=this.#v[e];if(o&&h){let a=o-(ct.now()-h);n.ttl=a,n.start=Date.now()}}return this.#x&&(n.size=this.#x[e]),n}dump(){let t=[];for(let e of this.#C({allowStale:!0})){let s=this.#o[e],i=this.#e[e],n=this.#c(i)?i.__staleWhileFetching:i;if(n===void 0||s===void 0)continue;let o={value:n};if(this.#_&&this.#v){o.ttl=this.#_[e];let h=ct.now()-this.#v[e];o.start=Math.floor(Date.now()-h)}this.#x&&(o.size=this.#x[e]),t.unshift([s,o])}return t}load(t){this.clear();for(let[e,s]of t){if(s.start){let i=Date.now()-s.start;s.start=ct.now()-i}this.set(e,s.value,s)}}set(t,e,s={}){if(e===void 0)return this.delete(t),this;let{ttl:i=this.ttl,start:n,noDisposeOnSet:o=this.noDisposeOnSet,sizeCalculation:h=this.sizeCalculation,status:a}=s,{noUpdateTTL:l=this.noUpdateTTL}=s,c=this.#I(t,e,s.size||0,h);if(this.maxEntrySize&&c>this.maxEntrySize)return a&&(a.set="miss",a.maxEntrySizeExceeded=!0),this.delete(t),this;let u=this.#l===0?void 0:this.#h.get(t);if(u===void 0)u=this.#l===0?this.#f:this.#S.length!==0?this.#S.pop():this.#l===this.#t?this.#$(!1):this.#l,this.#o[u]=t,this.#e[u]=e,this.#h.set(t,u),this.#m[this.#f]=u,this.#w[u]=this.#f,this.#f=u,this.#l++,this.#N(u,c,a),a&&(a.set="add"),l=!1;else{this.#R(u);let f=this.#e[u];if(e!==f){if(this.#H&&this.#c(f)){f.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:d}=f;d!==void 0&&!o&&(this.#y&&this.#r?.(d,t,"set"),this.#p&&this.#g?.push([d,t,"set"]))}else o||(this.#y&&this.#r?.(f,t,"set"),this.#p&&this.#g?.push([f,t,"set"]));if(this.#A(u),this.#N(u,c,a),this.#e[u]=e,a){a.set="replace";let d=f&&this.#c(f)?f.__staleWhileFetching:f;d!==void 0&&(a.oldValue=d)}}else a&&(a.set="update")}if(i!==0&&!this.#_&&this.#k(),this.#_&&(l||this.#n(u,i,n),a&&this.#E(a,u)),!o&&this.#p&&this.#g){let f=this.#g,d;for(;d=f?.shift();)this.#i?.(...d)}return this}pop(){try{for(;this.#l;){let t=this.#e[this.#d];if(this.#$(!0),this.#c(t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(this.#p&&this.#g){let t=this.#g,e;for(;e=t?.shift();)this.#i?.(...e)}}}#$(t){let e=this.#d,s=this.#o[e],i=this.#e[e];return this.#H&&this.#c(i)?i.__abortController.abort(new Error("evicted")):(this.#y||this.#p)&&(this.#y&&this.#r?.(i,s,"evict"),this.#p&&this.#g?.push([i,s,"evict"])),this.#A(e),t&&(this.#o[e]=void 0,this.#e[e]=void 0,this.#S.push(e)),this.#l===1?(this.#d=this.#f=0,this.#S.length=0):this.#d=this.#m[e],this.#h.delete(s),this.#l--,e}has(t,e={}){let{updateAgeOnHas:s=this.updateAgeOnHas,status:i}=e,n=this.#h.get(t);if(n!==void 0){let o=this.#e[n];if(this.#c(o)&&o.__staleWhileFetching===void 0)return!1;if(this.#b(n))i&&(i.has="stale",this.#E(i,n));else return s&&this.#O(n),i&&(i.has="hit",this.#E(i,n)),!0}else i&&(i.has="miss");return!1}peek(t,e={}){let{allowStale:s=this.allowStale}=e,i=this.#h.get(t);if(i===void 0||!s&&this.#b(i))return;let n=this.#e[i];return this.#c(n)?n.__staleWhileFetching:n}#D(t,e,s,i){let n=e===void 0?void 0:this.#e[e];if(this.#c(n))return n;let o=new Bt,{signal:h}=s;h?.addEventListener("abort",()=>o.abort(h.reason),{signal:o.signal});let a={signal:o.signal,options:s,context:i},l=(p,w=!1)=>{let{aborted:g}=o.signal,S=s.ignoreFetchAbort&&p!==void 0;if(s.status&&(g&&!w?(s.status.fetchAborted=!0,s.status.fetchError=o.signal.reason,S&&(s.status.fetchAbortIgnored=!0)):s.status.fetchResolved=!0),g&&!S&&!w)return u(o.signal.reason);let y=d;return this.#e[e]===d&&(p===void 0?y.__staleWhileFetching?this.#e[e]=y.__staleWhileFetching:this.delete(t):(s.status&&(s.status.fetchUpdated=!0),this.set(t,p,a.options))),p},c=p=>(s.status&&(s.status.fetchRejected=!0,s.status.fetchError=p),u(p)),u=p=>{let{aborted:w}=o.signal,g=w&&s.allowStaleOnFetchAbort,S=g||s.allowStaleOnFetchRejection,y=S||s.noDeleteOnFetchRejection,b=d;if(this.#e[e]===d&&(!y||b.__staleWhileFetching===void 0?this.delete(t):g||(this.#e[e]=b.__staleWhileFetching)),S)return s.status&&b.__staleWhileFetching!==void 0&&(s.status.returnedStale=!0),b.__staleWhileFetching;if(b.__returned===b)throw p},f=(p,w)=>{let g=this.#a?.(t,n,a);g&&g instanceof Promise&&g.then(S=>p(S===void 0?void 0:S),w),o.signal.addEventListener("abort",()=>{(!s.ignoreFetchAbort||s.allowStaleOnFetchAbort)&&(p(void 0),s.allowStaleOnFetchAbort&&(p=S=>l(S,!0)))})};s.status&&(s.status.fetchDispatched=!0);let d=new Promise(f).then(l,c),m=Object.assign(d,{__abortController:o,__staleWhileFetching:n,__returned:void 0});return e===void 0?(this.set(t,m,{...a.options,status:void 0}),e=this.#h.get(t)):this.#e[e]=m,m}#c(t){if(!this.#H)return!1;let e=t;return!!e&&e instanceof Promise&&e.hasOwnProperty("__staleWhileFetching")&&e.__abortController instanceof Bt}async fetch(t,e={}){let{allowStale:s=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,ttl:o=this.ttl,noDisposeOnSet:h=this.noDisposeOnSet,size:a=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:c=this.noUpdateTTL,noDeleteOnFetchRejection:u=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:d=this.ignoreFetchAbort,allowStaleOnFetchAbort:m=this.allowStaleOnFetchAbort,context:p,forceRefresh:w=!1,status:g,signal:S}=e;if(!this.#H)return g&&(g.fetch="get"),this.get(t,{allowStale:s,updateAgeOnGet:i,noDeleteOnStaleGet:n,status:g});let y={allowStale:s,updateAgeOnGet:i,noDeleteOnStaleGet:n,ttl:o,noDisposeOnSet:h,size:a,sizeCalculation:l,noUpdateTTL:c,noDeleteOnFetchRejection:u,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:m,ignoreFetchAbort:d,status:g,signal:S},b=this.#h.get(t);if(b===void 0){g&&(g.fetch="miss");let _=this.#D(t,b,y,p);return _.__returned=_}else{let _=this.#e[b];if(this.#c(_)){let jt=s&&_.__staleWhileFetching!==void 0;return g&&(g.fetch="inflight",jt&&(g.returnedStale=!0)),jt?_.__staleWhileFetching:_.__returned=_}let x=this.#b(b);if(!w&&!x)return g&&(g.fetch="hit"),this.#R(b),i&&this.#O(b),g&&this.#E(g,b),_;let V=this.#D(t,b,y,p),G=V.__staleWhileFetching!==void 0&&s;return g&&(g.fetch=x?"stale":"refresh",G&&x&&(g.returnedStale=!0)),G?V.__staleWhileFetching:V.__returned=V}}get(t,e={}){let{allowStale:s=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:n=this.noDeleteOnStaleGet,status:o}=e,h=this.#h.get(t);if(h!==void 0){let a=this.#e[h],l=this.#c(a);return o&&this.#E(o,h),this.#b(h)?(o&&(o.get="stale"),l?(o&&s&&a.__staleWhileFetching!==void 0&&(o.returnedStale=!0),s?a.__staleWhileFetching:void 0):(n||this.delete(t),o&&s&&(o.returnedStale=!0),s?a:void 0)):(o&&(o.get="hit"),l?a.__staleWhileFetching:(this.#R(h),i&&this.#O(h),a))}else o&&(o.get="miss")}#L(t,e){this.#w[e]=t,this.#m[t]=e}#R(t){t!==this.#f&&(t===this.#d?this.#d=this.#m[t]:this.#L(this.#w[t],this.#m[t]),this.#L(this.#f,t),this.#f=t)}delete(t){let e=!1;if(this.#l!==0){let s=this.#h.get(t);if(s!==void 0)if(e=!0,this.#l===1)this.clear();else{this.#A(s);let i=this.#e[s];if(this.#c(i)?i.__abortController.abort(new Error("deleted")):(this.#y||this.#p)&&(this.#y&&this.#r?.(i,t,"delete"),this.#p&&this.#g?.push([i,t,"delete"])),this.#h.delete(t),this.#o[s]=void 0,this.#e[s]=void 0,s===this.#f)this.#f=this.#w[s];else if(s===this.#d)this.#d=this.#m[s];else{let n=this.#w[s];this.#m[n]=this.#m[s];let o=this.#m[s];this.#w[o]=this.#w[s]}this.#l--,this.#S.push(s)}}if(this.#p&&this.#g?.length){let s=this.#g,i;for(;i=s?.shift();)this.#i?.(...i)}return e}clear(){for(let t of this.#F({allowStale:!0})){let e=this.#e[t];if(this.#c(e))e.__abortController.abort(new Error("deleted"));else{let s=this.#o[t];this.#y&&this.#r?.(e,s,"delete"),this.#p&&this.#g?.push([e,s,"delete"])}}if(this.#h.clear(),this.#e.fill(void 0),this.#o.fill(void 0),this.#_&&this.#v&&(this.#_.fill(0),this.#v.fill(0)),this.#x&&this.#x.fill(0),this.#d=0,this.#f=0,this.#S.length=0,this.#u=0,this.#l=0,this.#p&&this.#g){let t=this.#g,e;for(;e=t?.shift();)this.#i?.(...e)}}};var pt=require("path"),ti=require("url"),Bn=bt(require("fs"),1),J=require("fs"),it=require("fs/promises");var Yt=require("events"),De=bt(require("stream"),1),Js=require("string_decoder"),Us=typeof process=="object"&&process?process:{stdout:null,stderr:null},Dn=r=>!!r&&typeof r=="object"&&(r instanceof st||r instanceof De.default||Nn(r)||In(r)),Nn=r=>!!r&&typeof r=="object"&&r instanceof Yt.EventEmitter&&typeof r.pipe=="function"&&r.pipe!==De.default.Writable.prototype.pipe,In=r=>!!r&&typeof r=="object"&&r instanceof Yt.EventEmitter&&typeof r.write=="function"&&typeof r.end=="function",Z=Symbol("EOF"),Q=Symbol("maybeEmitEnd"),et=Symbol("emittedEnd"),zt=Symbol("emittingEnd"),xt=Symbol("emittedError"),Ut=Symbol("closed"),Gs=Symbol("read"),Gt=Symbol("flush"),qs=Symbol("flushChunk"),B=Symbol("encoding"),ft=Symbol("decoder"),v=Symbol("flowing"),vt=Symbol("paused"),dt=Symbol("resume"),O=Symbol("buffer"),R=Symbol("pipes"),H=Symbol("bufferLength"),He=Symbol("bufferPush"),qt=Symbol("bufferShift"),k=Symbol("objectMode"),A=Symbol("destroyed"),Fe=Symbol("error"),ke=Symbol("emitData"),Ks=Symbol("emitEnd"),Te=Symbol("emitEnd2"),q=Symbol("async"),$e=Symbol("abort"),Kt=Symbol("aborted"),Ot=Symbol("signal"),rt=Symbol("dataListeners"),N=Symbol("discarded"),Ht=r=>Promise.resolve().then(r),Mn=r=>r(),Ln=r=>r==="end"||r==="finish"||r==="prefinish",jn=r=>r instanceof ArrayBuffer||!!r&&typeof r=="object"&&r.constructor&&r.constructor.name==="ArrayBuffer"&&r.byteLength>=0,Pn=r=>!Buffer.isBuffer(r)&&ArrayBuffer.isView(r),Jt=class{src;dest;opts;ondrain;constructor(t,e,s){this.src=t,this.dest=e,this.opts=s,this.ondrain=()=>t[dt](),this.dest.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(t){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},Re=class extends Jt{unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(t,e,s){super(t,e,s),this.proxyErrors=i=>e.emit("error",i),t.on("error",this.proxyErrors)}},Vn=r=>!!r.objectMode,Wn=r=>!r.objectMode&&!!r.encoding&&r.encoding!=="buffer",st=class extends Yt.EventEmitter{[v]=!1;[vt]=!1;[R]=[];[O]=[];[k];[B];[q];[ft];[Z]=!1;[et]=!1;[zt]=!1;[Ut]=!1;[xt]=null;[H]=0;[A]=!1;[Ot];[Kt]=!1;[rt]=0;[N]=!1;writable=!0;readable=!0;constructor(...t){let e=t[0]||{};if(super(),e.objectMode&&typeof e.encoding=="string")throw new TypeError("Encoding and objectMode may not be used together");Vn(e)?(this[k]=!0,this[B]=null):Wn(e)?(this[B]=e.encoding,this[k]=!1):(this[k]=!1,this[B]=null),this[q]=!!e.async,this[ft]=this[B]?new Js.StringDecoder(this[B]):null,e&&e.debugExposeBuffer===!0&&Object.defineProperty(this,"buffer",{get:()=>this[O]}),e&&e.debugExposePipes===!0&&Object.defineProperty(this,"pipes",{get:()=>this[R]});let{signal:s}=e;s&&(this[Ot]=s,s.aborted?this[$e]():s.addEventListener("abort",()=>this[$e]()))}get bufferLength(){return this[H]}get encoding(){return this[B]}set encoding(t){throw new Error("Encoding must be set at instantiation time")}setEncoding(t){throw new Error("Encoding must be set at instantiation time")}get objectMode(){return this[k]}set objectMode(t){throw new Error("objectMode must be set at instantiation time")}get async(){return this[q]}set async(t){this[q]=this[q]||!!t}[$e](){this[Kt]=!0,this.emit("abort",this[Ot]?.reason),this.destroy(this[Ot]?.reason)}get aborted(){return this[Kt]}set aborted(t){}write(t,e,s){if(this[Kt])return!1;if(this[Z])throw new Error("write after end");if(this[A])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;typeof e=="function"&&(s=e,e="utf8"),e||(e="utf8");let i=this[q]?Ht:Mn;if(!this[k]&&!Buffer.isBuffer(t)){if(Pn(t))t=Buffer.from(t.buffer,t.byteOffset,t.byteLength);else if(jn(t))t=Buffer.from(t);else if(typeof t!="string")throw new Error("Non-contiguous data written to non-objectMode stream")}return this[k]?(this[v]&&this[H]!==0&&this[Gt](!0),this[v]?this.emit("data",t):this[He](t),this[H]!==0&&this.emit("readable"),s&&i(s),this[v]):t.length?(typeof t=="string"&&!(e===this[B]&&!this[ft]?.lastNeed)&&(t=Buffer.from(t,e)),Buffer.isBuffer(t)&&this[B]&&(t=this[ft].write(t)),this[v]&&this[H]!==0&&this[Gt](!0),this[v]?this.emit("data",t):this[He](t),this[H]!==0&&this.emit("readable"),s&&i(s),this[v]):(this[H]!==0&&this.emit("readable"),s&&i(s),this[v])}read(t){if(this[A])return null;if(this[N]=!1,this[H]===0||t===0||t&&t>this[H])return this[Q](),null;this[k]&&(t=null),this[O].length>1&&!this[k]&&(this[O]=[this[B]?this[O].join(""):Buffer.concat(this[O],this[H])]);let e=this[Gs](t||null,this[O][0]);return this[Q](),e}[Gs](t,e){if(this[k])this[qt]();else{let s=e;t===s.length||t===null?this[qt]():typeof s=="string"?(this[O][0]=s.slice(t),e=s.slice(0,t),this[H]-=t):(this[O][0]=s.subarray(t),e=s.subarray(0,t),this[H]-=t)}return this.emit("data",e),!this[O].length&&!this[Z]&&this.emit("drain"),e}end(t,e,s){return typeof t=="function"&&(s=t,t=void 0),typeof e=="function"&&(s=e,e="utf8"),t!==void 0&&this.write(t,e),s&&this.once("end",s),this[Z]=!0,this.writable=!1,(this[v]||!this[vt])&&this[Q](),this}[dt](){this[A]||(!this[rt]&&!this[R].length&&(this[N]=!0),this[vt]=!1,this[v]=!0,this.emit("resume"),this[O].length?this[Gt]():this[Z]?this[Q]():this.emit("drain"))}resume(){return this[dt]()}pause(){this[v]=!1,this[vt]=!0,this[N]=!1}get destroyed(){return this[A]}get flowing(){return this[v]}get paused(){return this[vt]}[He](t){this[k]?this[H]+=1:this[H]+=t.length,this[O].push(t)}[qt](){return this[k]?this[H]-=1:this[H]-=this[O][0].length,this[O].shift()}[Gt](t=!1){do;while(this[qs](this[qt]())&&this[O].length);!t&&!this[O].length&&!this[Z]&&this.emit("drain")}[qs](t){return this.emit("data",t),this[v]}pipe(t,e){if(this[A])return t;this[N]=!1;let s=this[et];return e=e||{},t===Us.stdout||t===Us.stderr?e.end=!1:e.end=e.end!==!1,e.proxyErrors=!!e.proxyErrors,s?e.end&&t.end():(this[R].push(e.proxyErrors?new Re(this,t,e):new Jt(this,t,e)),this[q]?Ht(()=>this[dt]()):this[dt]()),t}unpipe(t){let e=this[R].find(s=>s.dest===t);e&&(this[R].length===1?(this[v]&&this[rt]===0&&(this[v]=!1),this[R]=[]):this[R].splice(this[R].indexOf(e),1),e.unpipe())}addListener(t,e){return this.on(t,e)}on(t,e){let s=super.on(t,e);if(t==="data")this[N]=!1,this[rt]++,!this[R].length&&!this[v]&&this[dt]();else if(t==="readable"&&this[H]!==0)super.emit("readable");else if(Ln(t)&&this[et])super.emit(t),this.removeAllListeners(t);else if(t==="error"&&this[xt]){let i=e;this[q]?Ht(()=>i.call(this,this[xt])):i.call(this,this[xt])}return s}removeListener(t,e){return this.off(t,e)}off(t,e){let s=super.off(t,e);return t==="data"&&(this[rt]=this.listeners("data").length,this[rt]===0&&!this[N]&&!this[R].length&&(this[v]=!1)),s}removeAllListeners(t){let e=super.removeAllListeners(t);return(t==="data"||t===void 0)&&(this[rt]=0,!this[N]&&!this[R].length&&(this[v]=!1)),e}get emittedEnd(){return this[et]}[Q](){!this[zt]&&!this[et]&&!this[A]&&this[O].length===0&&this[Z]&&(this[zt]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[Ut]&&this.emit("close"),this[zt]=!1)}emit(t,...e){let s=e[0];if(t!=="error"&&t!=="close"&&t!==A&&this[A])return!1;if(t==="data")return!this[k]&&!s?!1:this[q]?(Ht(()=>this[ke](s)),!0):this[ke](s);if(t==="end")return this[Ks]();if(t==="close"){if(this[Ut]=!0,!this[et]&&!this[A])return!1;let n=super.emit("close");return this.removeAllListeners("close"),n}else if(t==="error"){this[xt]=s,super.emit(Fe,s);let n=!this[Ot]||this.listeners("error").length?super.emit("error",s):!1;return this[Q](),n}else if(t==="resume"){let n=super.emit("resume");return this[Q](),n}else if(t==="finish"||t==="prefinish"){let n=super.emit(t);return this.removeAllListeners(t),n}let i=super.emit(t,...e);return this[Q](),i}[ke](t){for(let s of this[R])s.dest.write(t)===!1&&this.pause();let e=this[N]?!1:super.emit("data",t);return this[Q](),e}[Ks](){return this[et]?!1:(this[et]=!0,this.readable=!1,this[q]?(Ht(()=>this[Te]()),!0):this[Te]())}[Te](){if(this[ft]){let e=this[ft].end();if(e){for(let s of this[R])s.dest.write(e);this[N]||super.emit("data",e)}}for(let e of this[R])e.end();let t=super.emit("end");return this.removeAllListeners("end"),t}async collect(){let t=Object.assign([],{dataLength:0});this[k]||(t.dataLength=0);let e=this.promise();return this.on("data",s=>{t.push(s),this[k]||(t.dataLength+=s.length)}),await e,t}async concat(){if(this[k])throw new Error("cannot concat in objectMode");let t=await this.collect();return this[B]?t.join(""):Buffer.concat(t,t.dataLength)}async promise(){return new Promise((t,e)=>{this.on(A,()=>e(new Error("stream destroyed"))),this.on("error",s=>e(s)),this.on("end",()=>t())})}[Symbol.asyncIterator](){this[N]=!1;let t=!1,e=async()=>(this.pause(),t=!0,{value:void 0,done:!0});return{next:()=>{if(t)return e();let i=this.read();if(i!==null)return Promise.resolve({done:!1,value:i});if(this[Z])return e();let n,o,h=u=>{this.off("data",a),this.off("end",l),this.off(A,c),e(),o(u)},a=u=>{this.off("error",h),this.off("end",l),this.off(A,c),this.pause(),n({value:u,done:!!this[Z]})},l=()=>{this.off("error",h),this.off("data",a),this.off(A,c),e(),n({done:!0,value:void 0})},c=()=>h(new Error("stream destroyed"));return new Promise((u,f)=>{o=f,n=u,this.once(A,c),this.once("error",h),this.once("end",l),this.once("data",a)})},throw:e,return:e,[Symbol.asyncIterator](){return this}}}[Symbol.iterator](){this[N]=!1;let t=!1,e=()=>(this.pause(),this.off(Fe,e),this.off(A,e),this.off("end",e),t=!0,{done:!0,value:void 0}),s=()=>{if(t)return e();let i=this.read();return i===null?e():{done:!1,value:i}};return this.once("end",e),this.once(Fe,e),this.once(A,e),{next:s,throw:e,return:e,[Symbol.iterator](){return this}}}destroy(t){if(this[A])return t?this.emit("error",t):this.emit(A),this;this[A]=!0,this[N]=!0,this[O].length=0,this[H]=0;let e=this;return typeof e.close=="function"&&!this[Ut]&&e.close(),t?this.emit("error",t):this.emit(A),this}static get isStream(){return Dn}};var zn=J.realpathSync.native,kt={lstatSync:J.lstatSync,readdir:J.readdir,readdirSync:J.readdirSync,readlinkSync:J.readlinkSync,realpathSync:zn,promises:{lstat:it.lstat,readdir:it.readdir,readlink:it.readlink,realpath:it.realpath}},ei=r=>!r||r===kt||r===Bn?kt:{...kt,...r,promises:{...kt.promises,...r.promises||{}}},si=/^\\\\\?\\([a-z]:)\\?$/i,Un=r=>r.replace(/\//g,"\\").replace(si,"$1\\"),Gn=/[\\\/]/,j=0,ii=1,ni=2,K=4,ri=6,oi=8,ot=10,ai=12,L=15,Ft=~L,Ne=16,Ys=32,Tt=64,z=128,Xt=256,Qt=512,Xs=Tt|z|Qt,qn=1023,Ie=r=>r.isFile()?oi:r.isDirectory()?K:r.isSymbolicLink()?ot:r.isCharacterDevice()?ni:r.isBlockDevice()?ri:r.isSocket()?ai:r.isFIFO()?ii:j,Zs=new Map,$t=r=>{let t=Zs.get(r);if(t)return t;let e=r.normalize("NFKD");return Zs.set(r,e),e},Qs=new Map,Zt=r=>{let t=Qs.get(r);if(t)return t;let e=$t(r.toLowerCase());return Qs.set(r,e),e},te=class extends Ct{constructor(){super({max:256})}},Me=class extends Ct{constructor(t=16*1024){super({maxSize:t,sizeCalculation:e=>e.length+1})}},hi=Symbol("PathScurry setAsCwd"),T=class{name;root;roots;parent;nocase;#t;#s;get dev(){return this.#s}#r;get mode(){return this.#r}#i;get nlink(){return this.#i}#a;get uid(){return this.#a}#l;get gid(){return this.#l}#u;get rdev(){return this.#u}#h;get blksize(){return this.#h}#o;get ino(){return this.#o}#e;get size(){return this.#e}#m;get blocks(){return this.#m}#w;get atimeMs(){return this.#w}#d;get mtimeMs(){return this.#d}#f;get ctimeMs(){return this.#f}#S;get birthtimeMs(){return this.#S}#g;get atime(){return this.#g}#x;get mtime(){return this.#x}#v;get ctime(){return this.#v}#_;get birthtime(){return this.#_}#y;#H;#p;#k;#O;#E;#n;#b;#T;#A;get path(){return(this.parent||this).fullpath()}constructor(t,e=j,s,i,n,o,h){this.name=t,this.#y=n?Zt(t):$t(t),this.#n=e&qn,this.nocase=n,this.roots=i,this.root=s||this,this.#b=o,this.#p=h.fullpath,this.#O=h.relative,this.#E=h.relativePosix,this.parent=h.parent,this.parent?this.#t=this.parent.#t:this.#t=ei(h.fs)}depth(){return this.#H!==void 0?this.#H:this.parent?this.#H=this.parent.depth()+1:this.#H=0}childrenCache(){return this.#b}resolve(t){if(!t)return this;let e=this.getRootString(t),i=t.substring(e.length).split(this.splitSep);return e?this.getRoot(e).#N(i):this.#N(i)}#N(t){let e=this;for(let s of t)e=e.child(s);return e}children(){let t=this.#b.get(this);if(t)return t;let e=Object.assign([],{provisional:0});return this.#b.set(this,e),this.#n&=~Ne,e}child(t,e){if(t===""||t===".")return this;if(t==="..")return this.parent||this;let s=this.children(),i=this.nocase?Zt(t):$t(t);for(let a of s)if(a.#y===i)return a;let n=this.parent?this.sep:"",o=this.#p?this.#p+n+t:void 0,h=this.newChild(t,j,{...e,parent:this,fullpath:o});return this.canReaddir()||(h.#n|=z),s.push(h),h}relative(){if(this.#O!==void 0)return this.#O;let t=this.name,e=this.parent;if(!e)return this.#O=this.name;let s=e.relative();return s+(!s||!e.parent?"":this.sep)+t}relativePosix(){if(this.sep==="/")return this.relative();if(this.#E!==void 0)return this.#E;let t=this.name,e=this.parent;if(!e)return this.#E=this.fullpathPosix();let s=e.relativePosix();return s+(!s||!e.parent?"":"/")+t}fullpath(){if(this.#p!==void 0)return this.#p;let t=this.name,e=this.parent;if(!e)return this.#p=this.name;let i=e.fullpath()+(e.parent?this.sep:"")+t;return this.#p=i}fullpathPosix(){if(this.#k!==void 0)return this.#k;if(this.sep==="/")return this.#k=this.fullpath();if(!this.parent){let i=this.fullpath().replace(/\\/g,"/");return/^[a-z]:\//i.test(i)?this.#k=`//?/${i}`:this.#k=i}let t=this.parent,e=t.fullpathPosix(),s=e+(!e||!t.parent?"":"/")+this.name;return this.#k=s}isUnknown(){return(this.#n&L)===j}isType(t){return this[`is${t}`]()}getType(){return this.isUnknown()?"Unknown":this.isDirectory()?"Directory":this.isFile()?"File":this.isSymbolicLink()?"SymbolicLink":this.isFIFO()?"FIFO":this.isCharacterDevice()?"CharacterDevice":this.isBlockDevice()?"BlockDevice":this.isSocket()?"Socket":"Unknown"}isFile(){return(this.#n&L)===oi}isDirectory(){return(this.#n&L)===K}isCharacterDevice(){return(this.#n&L)===ni}isBlockDevice(){return(this.#n&L)===ri}isFIFO(){return(this.#n&L)===ii}isSocket(){return(this.#n&L)===ai}isSymbolicLink(){return(this.#n&ot)===ot}lstatCached(){return this.#n&Ys?this:void 0}readlinkCached(){return this.#T}realpathCached(){return this.#A}readdirCached(){let t=this.children();return t.slice(0,t.provisional)}canReadlink(){if(this.#T)return!0;if(!this.parent)return!1;let t=this.#n&L;return!(t!==j&&t!==ot||this.#n&Xt||this.#n&z)}calledReaddir(){return!!(this.#n&Ne)}isENOENT(){return!!(this.#n&z)}isNamed(t){return this.nocase?this.#y===Zt(t):this.#y===$t(t)}async readlink(){let t=this.#T;if(t)return t;if(this.canReadlink()&&this.parent)try{let e=await this.#t.promises.readlink(this.fullpath()),s=this.parent.resolve(e);if(s)return this.#T=s}catch(e){this.#L(e.code);return}}readlinkSync(){let t=this.#T;if(t)return t;if(this.canReadlink()&&this.parent)try{let e=this.#t.readlinkSync(this.fullpath()),s=this.parent.resolve(e);if(s)return this.#T=s}catch(e){this.#L(e.code);return}}#I(t){this.#n|=Ne;for(let e=t.provisional;e<t.length;e++)t[e].#C()}#C(){this.#n&z||(this.#n=(this.#n|z)&Ft,this.#F())}#F(){let t=this.children();t.provisional=0;for(let e of t)e.#C()}#M(){this.#n|=Qt,this.#$()}#$(){if(this.#n&Tt)return;let t=this.#n;(t&L)===K&&(t&=Ft),this.#n=t|Tt,this.#F()}#D(t=""){t==="ENOTDIR"||t==="EPERM"?this.#$():t==="ENOENT"?this.#C():this.children().provisional=0}#c(t=""){t==="ENOTDIR"?this.parent.#$():t==="ENOENT"&&this.#C()}#L(t=""){let e=this.#n;e|=Xt,t==="ENOENT"&&(e|=z),(t==="EINVAL"||t==="UNKNOWN")&&(e&=Ft),this.#n=e,t==="ENOTDIR"&&this.parent&&this.parent.#$()}#R(t,e){return this.#z(t,e)||this.#B(t,e)}#B(t,e){let s=Ie(t),i=this.newChild(t.name,s,{parent:this}),n=i.#n&L;return n!==K&&n!==ot&&n!==j&&(i.#n|=Tt),e.unshift(i),e.provisional++,i}#z(t,e){for(let s=e.provisional;s<e.length;s++){let i=e[s];if((this.nocase?Zt(t.name):$t(t.name))===i.#y)return this.#U(t,i,s,e)}}#U(t,e,s,i){let n=e.name;return e.#n=e.#n&Ft|Ie(t),n!==t.name&&(e.name=t.name),s!==i.provisional&&(s===i.length-1?i.pop():i.splice(s,1),i.unshift(e)),i.provisional++,e}async lstat(){if(!(this.#n&z))try{return this.#W(await this.#t.promises.lstat(this.fullpath())),this}catch(t){this.#c(t.code)}}lstatSync(){if(!(this.#n&z))try{return this.#W(this.#t.lstatSync(this.fullpath())),this}catch(t){this.#c(t.code)}}#W(t){let{atime:e,atimeMs:s,birthtime:i,birthtimeMs:n,blksize:o,blocks:h,ctime:a,ctimeMs:l,dev:c,gid:u,ino:f,mode:d,mtime:m,mtimeMs:p,nlink:w,rdev:g,size:S,uid:y}=t;this.#g=e,this.#w=s,this.#_=i,this.#S=n,this.#h=o,this.#m=h,this.#v=a,this.#f=l,this.#s=c,this.#l=u,this.#o=f,this.#r=d,this.#x=m,this.#d=p,this.#i=w,this.#u=g,this.#e=S,this.#a=y;let b=Ie(t);this.#n=this.#n&Ft|b|Ys,b!==j&&b!==K&&b!==ot&&(this.#n|=Tt)}#P=[];#V=!1;#G(t){this.#V=!1;let e=this.#P.slice();this.#P.length=0,e.forEach(s=>s(null,t))}readdirCB(t,e=!1){if(!this.canReaddir()){e?t(null,[]):queueMicrotask(()=>t(null,[]));return}let s=this.children();if(this.calledReaddir()){let n=s.slice(0,s.provisional);e?t(null,n):queueMicrotask(()=>t(null,n));return}if(this.#P.push(t),this.#V)return;this.#V=!0;let i=this.fullpath();this.#t.readdir(i,{withFileTypes:!0},(n,o)=>{if(n)this.#D(n.code),s.provisional=0;else{for(let h of o)this.#R(h,s);this.#I(s)}this.#G(s.slice(0,s.provisional))})}#j;async readdir(){if(!this.canReaddir())return[];let t=this.children();if(this.calledReaddir())return t.slice(0,t.provisional);let e=this.fullpath();if(this.#j)await this.#j;else{let s=()=>{};this.#j=new Promise(i=>s=i);try{for(let i of await this.#t.promises.readdir(e,{withFileTypes:!0}))this.#R(i,t);this.#I(t)}catch(i){this.#D(i.code),t.provisional=0}this.#j=void 0,s()}return t.slice(0,t.provisional)}readdirSync(){if(!this.canReaddir())return[];let t=this.children();if(this.calledReaddir())return t.slice(0,t.provisional);let e=this.fullpath();try{for(let s of this.#t.readdirSync(e,{withFileTypes:!0}))this.#R(s,t);this.#I(t)}catch(s){this.#D(s.code),t.provisional=0}return t.slice(0,t.provisional)}canReaddir(){if(this.#n&Xs)return!1;let t=L&this.#n;return t===j||t===K||t===ot}shouldWalk(t,e){return(this.#n&K)===K&&!(this.#n&Xs)&&!t.has(this)&&(!e||e(this))}async realpath(){if(this.#A)return this.#A;if(!((Qt|Xt|z)&this.#n))try{let t=await this.#t.promises.realpath(this.fullpath());return this.#A=this.resolve(t)}catch{this.#M()}}realpathSync(){if(this.#A)return this.#A;if(!((Qt|Xt|z)&this.#n))try{let t=this.#t.realpathSync(this.fullpath());return this.#A=this.resolve(t)}catch{this.#M()}}[hi](t){if(t===this)return;let e=new Set([]),s=[],i=this;for(;i&&i.parent;)e.add(i),i.#O=s.join(this.sep),i.#E=s.join("/"),i=i.parent,s.push("..");for(i=t;i&&i.parent&&!e.has(i);)i.#O=void 0,i.#E=void 0,i=i.parent}},ee=class r extends T{sep="\\";splitSep=Gn;constructor(t,e=j,s,i,n,o,h){super(t,e,s,i,n,o,h)}newChild(t,e=j,s={}){return new r(t,e,this.root,this.roots,this.nocase,this.childrenCache(),s)}getRootString(t){return pt.win32.parse(t).root}getRoot(t){if(t=Un(t.toUpperCase()),t===this.root.name)return this.root;for(let[e,s]of Object.entries(this.roots))if(this.sameRoot(t,e))return this.roots[t]=s;return this.roots[t]=new mt(t,this).root}sameRoot(t,e=this.root.name){return t=t.toUpperCase().replace(/\//g,"\\").replace(si,"$1\\"),t===e}},se=class r extends T{splitSep="/";sep="/";constructor(t,e=j,s,i,n,o,h){super(t,e,s,i,n,o,h)}getRootString(t){return t.startsWith("/")?"/":""}getRoot(t){return this.root}newChild(t,e=j,s={}){return new r(t,e,this.root,this.roots,this.nocase,this.childrenCache(),s)}},ie=class{root;rootPath;roots;cwd;#t;#s;#r;nocase;#i;constructor(t=process.cwd(),e,s,{nocase:i,childrenCacheSize:n=16*1024,fs:o=kt}={}){this.#i=ei(o),(t instanceof URL||t.startsWith("file://"))&&(t=(0,ti.fileURLToPath)(t));let h=e.resolve(t);this.roots=Object.create(null),this.rootPath=this.parseRootPath(h),this.#t=new te,this.#s=new te,this.#r=new Me(n);let a=h.substring(this.rootPath.length).split(s);if(a.length===1&&!a[0]&&a.pop(),i===void 0)throw new TypeError("must provide nocase setting to PathScurryBase ctor");this.nocase=i,this.root=this.newRoot(this.#i),this.roots[this.rootPath]=this.root;let l=this.root,c=a.length-1,u=e.sep,f=this.rootPath,d=!1;for(let m of a){let p=c--;l=l.child(m,{relative:new Array(p).fill("..").join(u),relativePosix:new Array(p).fill("..").join("/"),fullpath:f+=(d?"":u)+m}),d=!0}this.cwd=l}depth(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.depth()}childrenCache(){return this.#r}resolve(...t){let e="";for(let n=t.length-1;n>=0;n--){let o=t[n];if(!(!o||o===".")&&(e=e?`${o}/${e}`:o,this.isAbsolute(o)))break}let s=this.#t.get(e);if(s!==void 0)return s;let i=this.cwd.resolve(e).fullpath();return this.#t.set(e,i),i}resolvePosix(...t){let e="";for(let n=t.length-1;n>=0;n--){let o=t[n];if(!(!o||o===".")&&(e=e?`${o}/${e}`:o,this.isAbsolute(o)))break}let s=this.#s.get(e);if(s!==void 0)return s;let i=this.cwd.resolve(e).fullpathPosix();return this.#s.set(e,i),i}relative(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.relative()}relativePosix(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.relativePosix()}basename(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.name}dirname(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),(t.parent||t).fullpath()}async readdir(t=this.cwd,e={withFileTypes:!0}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof T||(e=t,t=this.cwd);let{withFileTypes:s}=e;if(t.canReaddir()){let i=await t.readdir();return s?i:i.map(n=>n.name)}else return[]}readdirSync(t=this.cwd,e={withFileTypes:!0}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof T||(e=t,t=this.cwd);let{withFileTypes:s=!0}=e;return t.canReaddir()?s?t.readdirSync():t.readdirSync().map(i=>i.name):[]}async lstat(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.lstat()}lstatSync(t=this.cwd){return typeof t=="string"&&(t=this.cwd.resolve(t)),t.lstatSync()}async readlink(t=this.cwd,{withFileTypes:e}={withFileTypes:!1}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof T||(e=t.withFileTypes,t=this.cwd);let s=await t.readlink();return e?s:s?.fullpath()}readlinkSync(t=this.cwd,{withFileTypes:e}={withFileTypes:!1}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof T||(e=t.withFileTypes,t=this.cwd);let s=t.readlinkSync();return e?s:s?.fullpath()}async realpath(t=this.cwd,{withFileTypes:e}={withFileTypes:!1}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof T||(e=t.withFileTypes,t=this.cwd);let s=await t.realpath();return e?s:s?.fullpath()}realpathSync(t=this.cwd,{withFileTypes:e}={withFileTypes:!1}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof T||(e=t.withFileTypes,t=this.cwd);let s=t.realpathSync();return e?s:s?.fullpath()}async walk(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof T||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:i=!1,filter:n,walkFilter:o}=e,h=[];(!n||n(t))&&h.push(s?t:t.fullpath());let a=new Set,l=(u,f)=>{a.add(u),u.readdirCB((d,m)=>{if(d)return f(d);let p=m.length;if(!p)return f();let w=()=>{--p===0&&f()};for(let g of m)(!n||n(g))&&h.push(s?g:g.fullpath()),i&&g.isSymbolicLink()?g.realpath().then(S=>S?.isUnknown()?S.lstat():S).then(S=>S?.shouldWalk(a,o)?l(S,w):w()):g.shouldWalk(a,o)?l(g,w):w()},!0)},c=t;return new Promise((u,f)=>{l(c,d=>{if(d)return f(d);u(h)})})}walkSync(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof T||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:i=!1,filter:n,walkFilter:o}=e,h=[];(!n||n(t))&&h.push(s?t:t.fullpath());let a=new Set([t]);for(let l of a){let c=l.readdirSync();for(let u of c){(!n||n(u))&&h.push(s?u:u.fullpath());let f=u;if(u.isSymbolicLink()){if(!(i&&(f=u.realpathSync())))continue;f.isUnknown()&&f.lstatSync()}f.shouldWalk(a,o)&&a.add(f)}}return h}[Symbol.asyncIterator](){return this.iterate()}iterate(t=this.cwd,e={}){return typeof t=="string"?t=this.cwd.resolve(t):t instanceof T||(e=t,t=this.cwd),this.stream(t,e)[Symbol.asyncIterator]()}[Symbol.iterator](){return this.iterateSync()}*iterateSync(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof T||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:i=!1,filter:n,walkFilter:o}=e;(!n||n(t))&&(yield s?t:t.fullpath());let h=new Set([t]);for(let a of h){let l=a.readdirSync();for(let c of l){(!n||n(c))&&(yield s?c:c.fullpath());let u=c;if(c.isSymbolicLink()){if(!(i&&(u=c.realpathSync())))continue;u.isUnknown()&&u.lstatSync()}u.shouldWalk(h,o)&&h.add(u)}}}stream(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof T||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:i=!1,filter:n,walkFilter:o}=e,h=new st({objectMode:!0});(!n||n(t))&&h.write(s?t:t.fullpath());let a=new Set,l=[t],c=0,u=()=>{let f=!1;for(;!f;){let d=l.shift();if(!d){c===0&&h.end();return}c++,a.add(d);let m=(w,g,S=!1)=>{if(w)return h.emit("error",w);if(i&&!S){let y=[];for(let b of g)b.isSymbolicLink()&&y.push(b.realpath().then(_=>_?.isUnknown()?_.lstat():_));if(y.length){Promise.all(y).then(()=>m(null,g,!0));return}}for(let y of g)y&&(!n||n(y))&&(h.write(s?y:y.fullpath())||(f=!0));c--;for(let y of g){let b=y.realpathCached()||y;b.shouldWalk(a,o)&&l.push(b)}f&&!h.flowing?h.once("drain",u):p||u()},p=!0;d.readdirCB(m,!0),p=!1}};return u(),h}streamSync(t=this.cwd,e={}){typeof t=="string"?t=this.cwd.resolve(t):t instanceof T||(e=t,t=this.cwd);let{withFileTypes:s=!0,follow:i=!1,filter:n,walkFilter:o}=e,h=new st({objectMode:!0}),a=new Set;(!n||n(t))&&h.write(s?t:t.fullpath());let l=[t],c=0,u=()=>{let f=!1;for(;!f;){let d=l.shift();if(!d){c===0&&h.end();return}c++,a.add(d);let m=d.readdirSync();for(let p of m)(!n||n(p))&&(h.write(s?p:p.fullpath())||(f=!0));c--;for(let p of m){let w=p;if(p.isSymbolicLink()){if(!(i&&(w=p.realpathSync())))continue;w.isUnknown()&&w.lstatSync()}w.shouldWalk(a,o)&&l.push(w)}}f&&!h.flowing&&h.once("drain",u)};return u(),h}chdir(t=this.cwd){let e=this.cwd;this.cwd=typeof t=="string"?this.cwd.resolve(t):t,this.cwd[hi](e)}},mt=class extends ie{sep="\\";constructor(t=process.cwd(),e={}){let{nocase:s=!0}=e;super(t,pt.win32,"\\",{...e,nocase:s}),this.nocase=s;for(let i=this.cwd;i;i=i.parent)i.nocase=this.nocase}parseRootPath(t){return pt.win32.parse(t).root.toUpperCase()}newRoot(t){return new ee(this.rootPath,K,void 0,this.roots,this.nocase,this.childrenCache(),{fs:t})}isAbsolute(t){return t.startsWith("/")||t.startsWith("\\")||/^[a-z]:(\/|\\)/i.test(t)}},gt=class extends ie{sep="/";constructor(t=process.cwd(),e={}){let{nocase:s=!1}=e;super(t,pt.posix,"/",{...e,nocase:s}),this.nocase=s}parseRootPath(t){return"/"}newRoot(t){return new se(this.rootPath,K,void 0,this.roots,this.nocase,this.childrenCache(),{fs:t})}isAbsolute(t){return t.startsWith("/")}},Rt=class extends gt{constructor(t=process.cwd(),e={}){let{nocase:s=!0}=e;super(t,{...e,nocase:s})}},po=process.platform==="win32"?ee:se,li=process.platform==="win32"?mt:process.platform==="darwin"?Rt:gt;var ci=require("url");var Kn=r=>r.length>=1,Jn=r=>r.length>=1,wt=class r{#t;#s;#r;length;#i;#a;#l;#u;#h;#o;#e=!0;constructor(t,e,s,i){if(!Kn(t))throw new TypeError("empty pattern list");if(!Jn(e))throw new TypeError("empty glob list");if(e.length!==t.length)throw new TypeError("mismatched pattern list and glob list lengths");if(this.length=t.length,s<0||s>=this.length)throw new TypeError("index out of range");if(this.#t=t,this.#s=e,this.#r=s,this.#i=i,this.#r===0){if(this.isUNC()){let[n,o,h,a,...l]=this.#t,[c,u,f,d,...m]=this.#s;l[0]===""&&(l.shift(),m.shift());let p=[n,o,h,a,""].join("/"),w=[c,u,f,d,""].join("/");this.#t=[p,...l],this.#s=[w,...m],this.length=this.#t.length}else if(this.isDrive()||this.isAbsolute()){let[n,...o]=this.#t,[h,...a]=this.#s;o[0]===""&&(o.shift(),a.shift());let l=n+"/",c=h+"/";this.#t=[l,...o],this.#s=[c,...a],this.length=this.#t.length}}}pattern(){return this.#t[this.#r]}isString(){return typeof this.#t[this.#r]=="string"}isGlobstar(){return this.#t[this.#r]===F}isRegExp(){return this.#t[this.#r]instanceof RegExp}globString(){return this.#l=this.#l||(this.#r===0?this.isAbsolute()?this.#s[0]+this.#s.slice(1).join("/"):this.#s.join("/"):this.#s.slice(this.#r).join("/"))}hasMore(){return this.length>this.#r+1}rest(){return this.#a!==void 0?this.#a:this.hasMore()?(this.#a=new r(this.#t,this.#s,this.#r+1,this.#i),this.#a.#o=this.#o,this.#a.#h=this.#h,this.#a.#u=this.#u,this.#a):this.#a=null}isUNC(){let t=this.#t;return this.#h!==void 0?this.#h:this.#h=this.#i==="win32"&&this.#r===0&&t[0]===""&&t[1]===""&&typeof t[2]=="string"&&!!t[2]&&typeof t[3]=="string"&&!!t[3]}isDrive(){let t=this.#t;return this.#u!==void 0?this.#u:this.#u=this.#i==="win32"&&this.#r===0&&this.length>1&&typeof t[0]=="string"&&/^[a-z]:$/i.test(t[0])}isAbsolute(){let t=this.#t;return this.#o!==void 0?this.#o:this.#o=t[0]===""&&t.length>1||this.isDrive()||this.isUNC()}root(){let t=this.#t[0];return typeof t=="string"&&this.isAbsolute()&&this.#r===0?t:""}checkFollowGlobstar(){return!(this.#r===0||!this.isGlobstar()||!this.#e)}markFollowGlobstar(){return this.#r===0||!this.isGlobstar()||!this.#e?!1:(this.#e=!1,!0)}};var Yn=typeof process=="object"&&process&&typeof process.platform=="string"?process.platform:"linux",Dt=class{relative;relativeChildren;absolute;absoluteChildren;constructor(t,{nobrace:e,nocase:s,noext:i,noglobstar:n,platform:o=Yn}){this.relative=[],this.absolute=[],this.relativeChildren=[],this.absoluteChildren=[];let h={dot:!0,nobrace:e,nocase:s,noext:i,noglobstar:n,optimizationLevel:2,platform:o,nocomment:!0,nonegate:!0};for(let a of t){let l=new D(a,h);for(let c=0;c<l.set.length;c++){let u=l.set[c],f=l.globParts[c];if(!u||!f)throw new Error("invalid pattern object");let d=new wt(u,f,0,o),m=new D(d.globString(),h),p=f[f.length-1]==="**",w=d.isAbsolute();w?this.absolute.push(m):this.relative.push(m),p&&(w?this.absoluteChildren.push(m):this.relativeChildren.push(m))}}}ignored(t){let e=t.fullpath(),s=`${e}/`,i=t.relative()||".",n=`${i}/`;for(let o of this.relative)if(o.match(i)||o.match(n))return!0;for(let o of this.absolute)if(o.match(e)||o.match(s))return!0;return!1}childrenIgnored(t){let e=t.fullpath()+"/",s=(t.relative()||".")+"/";for(let i of this.relativeChildren)if(i.match(s))return!0;for(let i of this.absoluteChildren)if(i.match(e))return!0;return!1}};var Le=class r{store;constructor(t=new Map){this.store=t}copy(){return new r(new Map(this.store))}hasWalked(t,e){return this.store.get(t.fullpath())?.has(e.globString())}storeWalked(t,e){let s=t.fullpath(),i=this.store.get(s);i?i.add(e.globString()):this.store.set(s,new Set([e.globString()]))}},je=class{store=new Map;add(t,e,s){let i=(e?2:0)|(s?1:0),n=this.store.get(t);this.store.set(t,n===void 0?i:i&n)}entries(){return[...this.store.entries()].map(([t,e])=>[t,!!(e&2),!!(e&1)])}},Pe=class{store=new Map;add(t,e){if(!t.canReaddir())return;let s=this.store.get(t);s?s.find(i=>i.globString()===e.globString())||s.push(e):this.store.set(t,[e])}get(t){let e=this.store.get(t);if(!e)throw new Error("attempting to walk unknown path");return e}entries(){return this.keys().map(t=>[t,this.store.get(t)])}keys(){return[...this.store.keys()].filter(t=>t.canReaddir())}},Nt=class r{hasWalkedCache;matches=new je;subwalks=new Pe;patterns;follow;dot;opts;constructor(t,e){this.opts=t,this.follow=!!t.follow,this.dot=!!t.dot,this.hasWalkedCache=e?e.copy():new Le}processPatterns(t,e){this.patterns=e;let s=e.map(i=>[t,i]);for(let[i,n]of s){this.hasWalkedCache.storeWalked(i,n);let o=n.root(),h=n.isAbsolute()&&this.opts.absolute!==!1;if(o){i=i.resolve(o==="/"&&this.opts.root!==void 0?this.opts.root:o);let u=n.rest();if(u)n=u;else{this.matches.add(i,!0,!1);continue}}if(i.isENOENT())continue;let a,l,c=!1;for(;typeof(a=n.pattern())=="string"&&(l=n.rest());)i=i.resolve(a),n=l,c=!0;if(a=n.pattern(),l=n.rest(),c){if(this.hasWalkedCache.hasWalked(i,n))continue;this.hasWalkedCache.storeWalked(i,n)}if(typeof a=="string"){let u=a===".."||a===""||a===".";this.matches.add(i.resolve(a),h,u);continue}else if(a===F){(!i.isSymbolicLink()||this.follow||n.checkFollowGlobstar())&&this.subwalks.add(i,n);let u=l?.pattern(),f=l?.rest();if(!l||(u===""||u===".")&&!f)this.matches.add(i,h,u===""||u===".");else if(u===".."){let d=i.parent||i;f?this.hasWalkedCache.hasWalked(d,f)||this.subwalks.add(d,f):this.matches.add(d,h,!0)}}else a instanceof RegExp&&this.subwalks.add(i,n)}return this}subwalkTargets(){return this.subwalks.keys()}child(){return new r(this.opts,this.hasWalkedCache)}filterEntries(t,e){let s=this.subwalks.get(t),i=this.child();for(let n of e)for(let o of s){let h=o.isAbsolute(),a=o.pattern(),l=o.rest();a===F?i.testGlobstar(n,o,l,h):a instanceof RegExp?i.testRegExp(n,a,l,h):i.testString(n,a,l,h)}return i}testGlobstar(t,e,s,i){if((this.dot||!t.name.startsWith("."))&&(e.hasMore()||this.matches.add(t,i,!1),t.canReaddir()&&(this.follow||!t.isSymbolicLink()?this.subwalks.add(t,e):t.isSymbolicLink()&&(s&&e.checkFollowGlobstar()?this.subwalks.add(t,s):e.markFollowGlobstar()&&this.subwalks.add(t,e)))),s){let n=s.pattern();if(typeof n=="string"&&n!==".."&&n!==""&&n!==".")this.testString(t,n,s.rest(),i);else if(n===".."){let o=t.parent||t;this.subwalks.add(o,s)}else n instanceof RegExp&&this.testRegExp(t,n,s.rest(),i)}}testRegExp(t,e,s,i){e.test(t.name)&&(s?this.subwalks.add(t,s):this.matches.add(t,i,!1))}testString(t,e,s,i){t.isNamed(e)&&(s?this.subwalks.add(t,s):this.matches.add(t,i,!1))}};var Xn=(r,t)=>typeof r=="string"?new Dt([r],t):Array.isArray(r)?new Dt(r,t):r,ne=class{path;patterns;opts;seen=new Set;paused=!1;aborted=!1;#t=[];#s;#r;signal;maxDepth;constructor(t,e,s){this.patterns=t,this.path=e,this.opts=s,this.#r=!s.posix&&s.platform==="win32"?"\\":"/",s.ignore&&(this.#s=Xn(s.ignore,s)),this.maxDepth=s.maxDepth||1/0,s.signal&&(this.signal=s.signal,this.signal.addEventListener("abort",()=>{this.#t.length=0}))}#i(t){return this.seen.has(t)||!!this.#s?.ignored?.(t)}#a(t){return!!this.#s?.childrenIgnored?.(t)}pause(){this.paused=!0}resume(){if(this.signal?.aborted)return;this.paused=!1;let t;for(;!this.paused&&(t=this.#t.shift());)t()}onResume(t){this.signal?.aborted||(this.paused?this.#t.push(t):t())}async matchCheck(t,e){if(e&&this.opts.nodir)return;let s;if(this.opts.realpath){if(s=t.realpathCached()||await t.realpath(),!s)return;t=s}let i=t.isUnknown()||this.opts.stat;return this.matchCheckTest(i?await t.lstat():t,e)}matchCheckTest(t,e){return t&&(this.maxDepth===1/0||t.depth()<=this.maxDepth)&&(!e||t.canReaddir())&&(!this.opts.nodir||!t.isDirectory())&&!this.#i(t)?t:void 0}matchCheckSync(t,e){if(e&&this.opts.nodir)return;let s;if(this.opts.realpath){if(s=t.realpathCached()||t.realpathSync(),!s)return;t=s}let i=t.isUnknown()||this.opts.stat;return this.matchCheckTest(i?t.lstatSync():t,e)}matchFinish(t,e){if(this.#i(t))return;let s=this.opts.absolute===void 0?e:this.opts.absolute;this.seen.add(t);let i=this.opts.mark&&t.isDirectory()?this.#r:"";if(this.opts.withFileTypes)this.matchEmit(t);else if(s){let n=this.opts.posix?t.fullpathPosix():t.fullpath();this.matchEmit(n+i)}else{let n=this.opts.posix?t.relativePosix():t.relative(),o=this.opts.dotRelative&&!n.startsWith(".."+this.#r)?"."+this.#r:"";this.matchEmit(n?o+n+i:"."+i)}}async match(t,e,s){let i=await this.matchCheck(t,s);i&&this.matchFinish(i,e)}matchSync(t,e,s){let i=this.matchCheckSync(t,s);i&&this.matchFinish(i,e)}walkCB(t,e,s){this.signal?.aborted&&s(),this.walkCB2(t,e,new Nt(this.opts),s)}walkCB2(t,e,s,i){if(this.#a(t))return i();if(this.signal?.aborted&&i(),this.paused){this.onResume(()=>this.walkCB2(t,e,s,i));return}s.processPatterns(t,e);let n=1,o=()=>{--n===0&&i()};for(let[h,a,l]of s.matches.entries())this.#i(h)||(n++,this.match(h,a,l).then(()=>o()));for(let h of s.subwalkTargets()){if(this.maxDepth!==1/0&&h.depth()>=this.maxDepth)continue;n++;let a=h.readdirCached();h.calledReaddir()?this.walkCB3(h,a,s,o):h.readdirCB((l,c)=>this.walkCB3(h,c,s,o),!0)}o()}walkCB3(t,e,s,i){s=s.filterEntries(t,e);let n=1,o=()=>{--n===0&&i()};for(let[h,a,l]of s.matches.entries())this.#i(h)||(n++,this.match(h,a,l).then(()=>o()));for(let[h,a]of s.subwalks.entries())n++,this.walkCB2(h,a,s.child(),o);o()}walkCBSync(t,e,s){this.signal?.aborted&&s(),this.walkCB2Sync(t,e,new Nt(this.opts),s)}walkCB2Sync(t,e,s,i){if(this.#a(t))return i();if(this.signal?.aborted&&i(),this.paused){this.onResume(()=>this.walkCB2Sync(t,e,s,i));return}s.processPatterns(t,e);let n=1,o=()=>{--n===0&&i()};for(let[h,a,l]of s.matches.entries())this.#i(h)||this.matchSync(h,a,l);for(let h of s.subwalkTargets()){if(this.maxDepth!==1/0&&h.depth()>=this.maxDepth)continue;n++;let a=h.readdirSync();this.walkCB3Sync(h,a,s,o)}o()}walkCB3Sync(t,e,s,i){s=s.filterEntries(t,e);let n=1,o=()=>{--n===0&&i()};for(let[h,a,l]of s.matches.entries())this.#i(h)||this.matchSync(h,a,l);for(let[h,a]of s.subwalks.entries())n++,this.walkCB2Sync(h,a,s.child(),o);o()}},It=class extends ne{matches;constructor(t,e,s){super(t,e,s),this.matches=new Set}matchEmit(t){this.matches.add(t)}async walk(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&await this.path.lstat(),await new Promise((t,e)=>{this.walkCB(this.path,this.patterns,()=>{this.signal?.aborted?e(this.signal.reason):t(this.matches)})}),this.matches}walkSync(){if(this.signal?.aborted)throw this.signal.reason;return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>{if(this.signal?.aborted)throw this.signal.reason}),this.matches}},Mt=class extends ne{results;constructor(t,e,s){super(t,e,s),this.results=new st({signal:this.signal,objectMode:!0}),this.results.on("drain",()=>this.resume()),this.results.on("resume",()=>this.resume())}matchEmit(t){this.results.write(t),this.results.flowing||this.pause()}stream(){let t=this.path;return t.isUnknown()?t.lstat().then(()=>{this.walkCB(t,this.patterns,()=>this.results.end())}):this.walkCB(t,this.patterns,()=>this.results.end()),this.results}streamSync(){return this.path.isUnknown()&&this.path.lstatSync(),this.walkCBSync(this.path,this.patterns,()=>this.results.end()),this.results}};var Zn=typeof process=="object"&&process&&typeof process.platform=="string"?process.platform:"linux",U=class{absolute;cwd;root;dot;dotRelative;follow;ignore;magicalBraces;mark;matchBase;maxDepth;nobrace;nocase;nodir;noext;noglobstar;pattern;platform;realpath;scurry;stat;signal;windowsPathsNoEscape;withFileTypes;opts;patterns;constructor(t,e){if(!e)throw new TypeError("glob options required");if(this.withFileTypes=!!e.withFileTypes,this.signal=e.signal,this.follow=!!e.follow,this.dot=!!e.dot,this.dotRelative=!!e.dotRelative,this.nodir=!!e.nodir,this.mark=!!e.mark,e.cwd?(e.cwd instanceof URL||e.cwd.startsWith("file://"))&&(e.cwd=(0,ci.fileURLToPath)(e.cwd)):this.cwd="",this.cwd=e.cwd||"",this.root=e.root,this.magicalBraces=!!e.magicalBraces,this.nobrace=!!e.nobrace,this.noext=!!e.noext,this.realpath=!!e.realpath,this.absolute=e.absolute,this.noglobstar=!!e.noglobstar,this.matchBase=!!e.matchBase,this.maxDepth=typeof e.maxDepth=="number"?e.maxDepth:1/0,this.stat=!!e.stat,this.ignore=e.ignore,this.withFileTypes&&this.absolute!==void 0)throw new Error("cannot set absolute and withFileTypes:true");if(typeof t=="string"&&(t=[t]),this.windowsPathsNoEscape=!!e.windowsPathsNoEscape||e.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(t=t.map(a=>a.replace(/\\/g,"/"))),this.matchBase){if(e.noglobstar)throw new TypeError("base matching requires globstar");t=t.map(a=>a.includes("/")?a:`./**/${a}`)}if(this.pattern=t,this.platform=e.platform||Zn,this.opts={...e,platform:this.platform},e.scurry){if(this.scurry=e.scurry,e.nocase!==void 0&&e.nocase!==e.scurry.nocase)throw new Error("nocase option contradicts provided scurry option")}else{let a=e.platform==="win32"?mt:e.platform==="darwin"?Rt:e.platform?gt:li;this.scurry=new a(this.cwd,{nocase:e.nocase,fs:e.fs})}this.nocase=this.scurry.nocase;let s=this.platform==="darwin"||this.platform==="win32",i={...e,dot:this.dot,matchBase:this.matchBase,nobrace:this.nobrace,nocase:this.nocase,nocaseMagicOnly:s,nocomment:!0,noext:this.noext,nonegate:!0,optimizationLevel:2,platform:this.platform,windowsPathsNoEscape:this.windowsPathsNoEscape,debug:!!this.opts.debug},n=this.pattern.map(a=>new D(a,i)),[o,h]=n.reduce((a,l)=>(a[0].push(...l.set),a[1].push(...l.globParts),a),[[],[]]);this.patterns=o.map((a,l)=>{let c=h[l];if(!c)throw new Error("invalid pattern object");return new wt(a,c,0,this.platform)})}async walk(){return[...await new It(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase}).walk()]}walkSync(){return[...new It(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase}).walkSync()]}stream(){return new Mt(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase}).stream()}streamSync(){return new Mt(this.patterns,this.scurry.cwd,{...this.opts,maxDepth:this.maxDepth!==1/0?this.maxDepth+this.scurry.cwd.depth():1/0,platform:this.platform,nocase:this.nocase}).streamSync()}iterateSync(){return this.streamSync()[Symbol.iterator]()}[Symbol.iterator](){return this.iterateSync()}iterate(){return this.stream()[Symbol.asyncIterator]()}[Symbol.asyncIterator](){return this.iterate()}};var Ve=(r,t={})=>{Array.isArray(r)||(r=[r]);for(let e of r)if(new D(e,t).hasMagic())return!0;return!1};function oe(r,t={}){return new U(r,t).streamSync()}function fi(r,t={}){return new U(r,t).stream()}function di(r,t={}){return new U(r,t).walkSync()}async function ui(r,t={}){return new U(r,t).walk()}function ae(r,t={}){return new U(r,t).iterateSync()}function pi(r,t={}){return new U(r,t).iterate()}var Qn=oe,tr=Object.assign(fi,{sync:oe}),er=ae,sr=Object.assign(pi,{sync:ae}),ir=Object.assign(di,{stream:oe,iterate:ae}),re=Object.assign(ui,{glob:ui,globSync:di,sync:ir,globStream:fi,stream:tr,globStreamSync:oe,streamSync:Qn,globIterate:pi,iterate:sr,globIterateSync:ae,iterateSync:er,Glob:U,hasMagic:Ve,escape:lt,unescape:W});re.glob=re;function mi(){return{debug:r=>{},info:r=>{},warning:r=>{},error:r=>{},setFailed:r=>{process.exit(1)}}}function gi(){return{eligible:()=>{},result:()=>{},failure:r=>{}}}var P=mi(),nt=class r extends Error{constructor(e,s,i){super(i);this.reason=e;this.cause=s}static of(e,s){return new r(e,void 0,s)}};function nr(r){let t=r.split("."),e=t[t.length-1],s=ds[e.trim().toLowerCase()];if(!s)throw new Error(`Unrecognized hash algorithm for file: ${r}`);return s}function wi(r){if(r.match(fs)!=null&&cs[r.length]!=null)return"base64";if(!(r.match(us)!=null&&hs[r.length]!=null))throw nt.of("hash-value-invalid",`Invalid hash value: ${r}`);return"hex"}function rr(r){let t=(0,C.dirname)(r),s=(0,C.basename)(r).split(".");return s.length<3?(0,C.join)(t,s[0]):(0,C.join)(t,s.slice(0,s.length-1).join("."))}async function or(r){if(!(0,bi.existsSync)(r))throw P.warning(`Subject file not found at '${r}'`),nt.of("subject-not-found");return{file:r,contents:await(0,We.readFile)(r)}}async function ar(r){P.debug(`- Reading hash file at '${r}'`);let t=(0,We.readFile)(r,"utf8"),e=nr(r),s=(await t).split(`
`).map(n=>n.trim()).filter(n=>n.length>0&&n.replace(/\s/g,"").length>0),i=s.map(n=>{let o=n.split(/[ \t]{1,3}/);switch(o.length){case 1:if(s.length>1)throw nt.of("hash-value-invalid",`Invalid hash file format at '${r}': subject-less hash files can only have one hash`);return{hash:o[0],encoding:wi(o[0]),subject:(0,C.resolve)((0,C.normalize)((0,C.join)((0,C.dirname)(r),(0,C.basename)(rr(r))))),hashfile:r,algorithm:e};case 2:return{hash:o[0],encoding:wi(o[0]),subject:(0,C.resolve)((0,C.normalize)((0,C.join)((0,C.dirname)(r),(0,C.basename)(o[1])))),hashfile:r,algorithm:e};default:P.warning(`Unrecognized hash file format at '${r}'`);return}}).filter(n=>!!n);for(let n of i)if((n.encoding==="hex"?as:ls)[e]!==n.hash.length)throw nt.of("hash-value-invalid",`Invalid hash value for file at '${r}': ${n.hash}`);return i}async function hr(r,t){let{algorithm:e,encoding:s,hash:i}=r;P.debug(`- Comparing hash for '${t.file}' (algorithm: ${e}, encoding: ${s}, expected: ${i})`);let n=await ms(e,s,t.contents),o=n===i;return P.debug(`- Hash comparison result for '${t.file}': ${o?"valid":"invalid"} (actual: ${n})`),o?{err:!1,file:t.file,peer:r.subject,found:!0,valid:!0,algorithm:e,encoding:s}:{err:!0,found:!0,valid:!1,file:t.file,peer:r.subject,reason:"hash-mismatch",expected:i,actual:n,algorithm:e,encoding:s}}async function lr(r){let t=(0,C.resolve)((0,C.normalize)(r));try{return Promise.all((await ar(t)).map(async e=>{try{return await hr(e,await or(e.subject))}catch(s){if(s instanceof nt)return{err:!0,file:t,valid:!1,reason:s.reason};throw s}}))}catch(e){if(e instanceof nt)return[{err:!0,file:t,valid:!1,reason:e.reason}];throw e}}function cr(r,t,e,s,i){i.eligible(r);for(let n of t.concat(e))i.result(n);for(let n of s)i.failure(n)}async function Be(r,t,e,s,i,n){let o=i||gi();P=n||P;let h;if(s){let d=St.join(","),m=r.map(p=>`${p}/**/*.{${d}}`).concat(e.map(p=>`!${p}`));h=await re(m)}else h=r.filter(d=>!e.includes(d));if(h.length===0){let d="No hash files to verify.";return t?P.error(d):P.info(d),{verifiedFiles:[],failedVerifications:[],errors:[]}}P.debug(`Verifying ${h.length} hash files...`);let a=h.map(d=>(P.debug(`- Verifying '${d}'`),{file:d,operation:lr(d)})),l=[],c=[];for(let d of a)l.push(...await d.operation);let u=l.filter(({valid:d})=>d),f=l.filter(({valid:d})=>!d);return u.length>0&&P.info(`Verified ${u.length} hash files`),cr(h,u,f,c,o),{verifiedFiles:u,failedVerifications:f,errors:c}}var at="hashlock",ur="0.0.1",fr=["md5","sha1"],dr=St.filter(r=>!fr.includes(r));function pr(r,t){r.version(ur);let e=(i,n)=>(n||[]).concat(i.split(",")),s=i=>i.split(",");r.command("check",{isDefault:!0}).option("--strict","activate strict matching mode").option("-i, --ignore <paths>","paths to ignore from matching").argument("[hashfiles...]","globs to check for hashfiles to check",e,[]).action(async function(){await t("check",this)}),r.command("generate").option("-a, --algorithms <values>","comma-separated algorithms to use",s,dr).option("-o, --out <path>","output file path; if not provided, only one subject path is allowed").argument("<subjects...>","globs or paths of subject files",e).action(async function(){await t("generate",this)}),r.command("freshen").option("-i, --ignore","paths to ignore from matching").option("-a, --algorithms <values>","comma-separated algorithms to consider eligible",s,St).argument("[hashfiles...]","globs or paths of hashfiles to update",e,["."]).action(async function(){await t("freshen",this)}),r.addHelpText("after",`
Examples:
  $ ${at} check .
  $ ${at} check --strict --ignore ./some_root ./check-these ./also-these
  $ ${at} generate subject.txt
  $ ${at} generate -a sha256 -o ./hashfile.sha256 ./subject.txt
  $ ${at} freshen .
  $ ${at} freshen --ignore ./some_root ./freshen-these ./also-these`)}async function mr(r,t,e){pr(r,e),r.parse(t)}function yi(r,t){return r.length>0?r:t()}async function gr(r,t,e){let s=r.opts(),i=yi(r.args,()=>["."]),n=s.ignore?yi(s.ignore||[],()=>[]):[],o=s.strict===!0,h=await Be(i,o,n,!0,e,t);return h.errors.length>0||h.failedVerifications.length>0?1:0}async function wr(r,t){return 0}async function br(r,t){return 0}function _i(r=Si.argv,t=new ns(at)){mr(t,r,async(e,s)=>{let i=rs(s);switch(e){case"check":return gr(s,i,os(s));case"generate":return wr(s,i);case"freshen":return br(s,i)}})}_i();
